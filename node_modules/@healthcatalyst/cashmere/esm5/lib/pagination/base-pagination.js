/**
 * @fileoverview added by tsickle
 * Generated from: lib/pagination/base-pagination.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { EventEmitter, Input, Output, Component } from '@angular/core';
import { coerceNumberProperty } from '@angular/cdk/coercion';
import { Initializable } from '../shared/initializable';
/**
 * Base Pagination class for shared functionality
 *
 */
var BasePaginationComponent = /** @class */ (function (_super) {
    tslib_1.__extends(BasePaginationComponent, _super);
    function BasePaginationComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._length = 0;
        _this._pageNumber = 1;
        _this._pageSize = BasePaginationComponent._DEFAULT_PAGE_SIZE;
        /**
         * Event emitted when the paginator changes the page size or page index.
         */
        _this.page = new EventEmitter();
        /**
         * Emits the new page number when the page number changes.
         */
        _this.pageNumberChange = new EventEmitter();
        /**
         * Emits the new page size when the page size changes.
         */
        _this.pageSizeChange = new EventEmitter();
        return _this;
    }
    Object.defineProperty(BasePaginationComponent.prototype, "length", {
        /**
         * The total number of items to be paged through
         */
        get: /**
         * The total number of items to be paged through
         * @return {?}
         */
        function () {
            return this._length;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._length = coerceNumberProperty(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BasePaginationComponent.prototype, "pageNumber", {
        /** The currently displayed page. *Defaults to 1.* */
        get: /**
         * The currently displayed page. *Defaults to 1.*
         * @return {?}
         */
        function () {
            return this._pageNumber;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            var _this = this;
            /** @type {?} */
            var prevPageNumber = this._pageNumber;
            this._pageNumber = value;
            /** @type {?} */
            var sanitizedValue = this._sanitizePageNumber(value);
            if (sanitizedValue !== value) {
                setTimeout((/**
                 * @return {?}
                 */
                function () { return (_this.pageNumber = sanitizedValue); }));
            }
            else {
                this.pageNumberChange.emit(this.pageNumber);
                this._emitPageEvent(prevPageNumber);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BasePaginationComponent.prototype, "pageSize", {
        /** Number of items to display on a page. *Defaults to 20.* */
        get: /**
         * Number of items to display on a page. *Defaults to 20.*
         * @return {?}
         */
        function () {
            return this._pageSize;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._pageSize = coerceNumberProperty(value);
            this._pageSizeUpdated();
            this.pageSizeChange.emit(this.pageSize);
            this._emitPageEvent(this.pageNumber);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    BasePaginationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this._markInitialized();
    };
    Object.defineProperty(BasePaginationComponent.prototype, "totalPages", {
        /**
         * The computed total number of pages
         */
        get: /**
         * The computed total number of pages
         * @return {?}
         */
        function () {
            return Math.ceil(this._length / this._pageSize);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BasePaginationComponent.prototype, "_isFirstPage", {
        get: /**
         * @return {?}
         */
        function () {
            return this._pageNumber === 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BasePaginationComponent.prototype, "_isLastPage", {
        get: /**
         * @return {?}
         */
        function () {
            return !!(this.totalPages && this._pageNumber === this.totalPages);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Changes the page size so that the first item displayed on the page will still be
     * displayed using the new page size.
     *
     * For example, if the page size is 10 and on the second page (items indexed 11-20) then
     * switching so that the page size is 5 will set the third page as the current page so
     * that the 11th item will still be displayed.
     */
    /**
     * Changes the page size so that the first item displayed on the page will still be
     * displayed using the new page size.
     *
     * For example, if the page size is 10 and on the second page (items indexed 11-20) then
     * switching so that the page size is 5 will set the third page as the current page so
     * that the 11th item will still be displayed.
     * @param {?} pageSize
     * @return {?}
     */
    BasePaginationComponent.prototype._changePageSize = /**
     * Changes the page size so that the first item displayed on the page will still be
     * displayed using the new page size.
     *
     * For example, if the page size is 10 and on the second page (items indexed 11-20) then
     * switching so that the page size is 5 will set the third page as the current page so
     * that the 11th item will still be displayed.
     * @param {?} pageSize
     * @return {?}
     */
    function (pageSize) {
        // Current page needs to be updated to reflect the new page size. Navigate to the page
        // containing the previous page's first item.
        /** @type {?} */
        var startIndex = (this.pageNumber - 1) * this.pageSize;
        this.pageSize = pageSize;
        this.pageNumber = Math.ceil(startIndex / pageSize) + 1;
    };
    /**
     * @return {?}
     */
    BasePaginationComponent.prototype._pageSizeUpdated = /**
     * @return {?}
     */
    function () { };
    /**
     * @private
     * @param {?} pageNumber
     * @return {?}
     */
    BasePaginationComponent.prototype._sanitizePageNumber = /**
     * @private
     * @param {?} pageNumber
     * @return {?}
     */
    function (pageNumber) {
        /** @type {?} */
        var number = Math.max(coerceNumberProperty(pageNumber), 1);
        return number > this.totalPages ? this.totalPages : number;
    };
    /**
     * @private
     * @param {?} previousPageNumber
     * @return {?}
     */
    BasePaginationComponent.prototype._emitPageEvent = /**
     * @private
     * @param {?} previousPageNumber
     * @return {?}
     */
    function (previousPageNumber) {
        this.page.emit({
            previousPageNumber: previousPageNumber,
            pageNumber: this.pageNumber,
            pageSize: this.pageSize,
            length: this.length
        });
    };
    BasePaginationComponent._DEFAULT_PAGE_SIZE = 20;
    BasePaginationComponent.decorators = [
        { type: Component, args: [{
                    template: ''
                }] }
    ];
    BasePaginationComponent.propDecorators = {
        length: [{ type: Input }],
        pageNumber: [{ type: Input }],
        pageSize: [{ type: Input }],
        page: [{ type: Output }],
        pageNumberChange: [{ type: Output }],
        pageSizeChange: [{ type: Output }]
    };
    return BasePaginationComponent;
}(Initializable));
export { BasePaginationComponent };
if (false) {
    /** @type {?} */
    BasePaginationComponent._DEFAULT_PAGE_SIZE;
    /**
     * @type {?}
     * @private
     */
    BasePaginationComponent.prototype._length;
    /**
     * @type {?}
     * @private
     */
    BasePaginationComponent.prototype._pageNumber;
    /**
     * @type {?}
     * @private
     */
    BasePaginationComponent.prototype._pageSize;
    /**
     * Event emitted when the paginator changes the page size or page index.
     * @type {?}
     */
    BasePaginationComponent.prototype.page;
    /**
     * Emits the new page number when the page number changes.
     * @type {?}
     */
    BasePaginationComponent.prototype.pageNumberChange;
    /**
     * Emits the new page size when the page size changes.
     * @type {?}
     */
    BasePaginationComponent.prototype.pageSizeChange;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1wYWdpbmF0aW9uLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGhlYWx0aGNhdGFseXN0L2Nhc2htZXJlLyIsInNvdXJjZXMiOlsibGliL3BhZ2luYXRpb24vYmFzZS1wYWdpbmF0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sRUFBQyxZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBVSxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDN0UsT0FBTyxFQUFDLG9CQUFvQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDM0QsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLHlCQUF5QixDQUFDOzs7OztBQVF0RDtJQUc2QyxtREFBYTtJQUgxRDtRQUFBLHFFQStHQztRQS9GVyxhQUFPLEdBQVcsQ0FBQyxDQUFDO1FBRXBCLGlCQUFXLEdBQVcsQ0FBQyxDQUFDO1FBOEJ4QixlQUFTLEdBQVcsdUJBQXVCLENBQUMsa0JBQWtCLENBQUM7Ozs7UUFJOUQsVUFBSSxHQUE0QixJQUFJLFlBQVksRUFBYSxDQUFDOzs7O1FBSTlELHNCQUFnQixHQUF5QixJQUFJLFlBQVksRUFBVSxDQUFDOzs7O1FBR3BFLG9CQUFjLEdBQXlCLElBQUksWUFBWSxFQUFVLENBQUM7O0lBb0QvRSxDQUFDO0lBdEdHLHNCQUNJLDJDQUFNO1FBSlY7O1dBRUc7Ozs7O1FBQ0g7WUFFSSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDeEIsQ0FBQzs7Ozs7UUFDRCxVQUFXLEtBQWE7WUFDcEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMvQyxDQUFDOzs7T0FIQTtJQVFELHNCQUNJLCtDQUFVO1FBRmQscURBQXFEOzs7OztRQUNyRDtZQUVJLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQztRQUM1QixDQUFDOzs7OztRQUNELFVBQWUsS0FBYTtZQUE1QixpQkFXQzs7Z0JBVlMsY0FBYyxHQUFHLElBQUksQ0FBQyxX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SUExR2EsMENBQWtCLEdBQUcsRUFBRSxDQUFDOztnQkFKekMsU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxFQUFFO2lCQUNmOzs7eUJBT0ksS0FBSzs2QkFXTCxLQUFLOzJCQWtCTCxLQUFLO3VCQWFMLE1BQU07bUNBSU4sTUFBTTtpQ0FHTixNQUFNOztJQXFEWCw4QkFBQztDQUFBLEFBL0dELENBRzZDLGFBQWEsR0E0R3pEO1NBNUdZLHVCQUF1Qjs7O0lBQ2hDLDJDQUFzQzs7Ozs7SUFZdEMsMENBQTRCOzs7OztJQUU1Qiw4Q0FBZ0M7Ozs7O0lBOEJoQyw0Q0FBdUU7Ozs7O0lBR3ZFLHVDQUN1RTs7Ozs7SUFHdkUsbURBQzZFOzs7OztJQUU3RSxpREFDMkUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0V2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgT25Jbml0LCBDb21wb25lbnR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtjb2VyY2VOdW1iZXJQcm9wZXJ0eX0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcbmltcG9ydCB7SW5pdGlhbGl6YWJsZX0gZnJvbSAnLi4vc2hhcmVkL2luaXRpYWxpemFibGUnO1xuaW1wb3J0IHtQYWdlRXZlbnR9IGZyb20gJy4vcGFnZS1ldmVudCc7XG5pbXBvcnQge21hcCwgZGlzdGluY3RVbnRpbENoYW5nZWR9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogQmFzZSBQYWdpbmF0aW9uIGNsYXNzIGZvciBzaGFyZWQgZnVuY3Rpb25hbGl0eVxuICogKi9cbkBDb21wb25lbnQoe1xuICAgIHRlbXBsYXRlOiAnJ1xufSlcbmV4cG9ydCBjbGFzcyBCYXNlUGFnaW5hdGlvbkNvbXBvbmVudCBleHRlbmRzIEluaXRpYWxpemFibGUgaW1wbGVtZW50cyBPbkluaXQge1xuICAgIHB1YmxpYyBzdGF0aWMgX0RFRkFVTFRfUEFHRV9TSVpFID0gMjA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdG90YWwgbnVtYmVyIG9mIGl0ZW1zIHRvIGJlIHBhZ2VkIHRocm91Z2hcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9XG4gICAgc2V0IGxlbmd0aCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IGNvZXJjZU51bWJlclByb3BlcnR5KHZhbHVlKTtcbiAgICB9XG4gICAgcHJpdmF0ZSBfbGVuZ3RoOiBudW1iZXIgPSAwO1xuXG4gICAgcHJpdmF0ZSBfcGFnZU51bWJlcjogbnVtYmVyID0gMTtcbiAgICAvKiogVGhlIGN1cnJlbnRseSBkaXNwbGF5ZWQgcGFnZS4gKkRlZmF1bHRzIHRvIDEuKiAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IHBhZ2VOdW1iZXIoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhZ2VOdW1iZXI7XG4gICAgfVxuICAgIHNldCBwYWdlTnVtYmVyKHZhbHVlOiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgcHJldlBhZ2VOdW1iZXIgPSB0aGlzLl9wYWdlTnVtYmVyO1xuICAgICAgICB0aGlzLl9wYWdlTnVtYmVyID0gdmFsdWU7XG5cbiAgICAgICAgY29uc3Qgc2FuaXRpemVkVmFsdWUgPSB0aGlzLl9zYW5pdGl6ZVBhZ2VOdW1iZXIodmFsdWUpO1xuICAgICAgICBpZiAoc2FuaXRpemVkVmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+ICh0aGlzLnBhZ2VOdW1iZXIgPSBzYW5pdGl6ZWRWYWx1ZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYWdlTnVtYmVyQ2hhbmdlLmVtaXQodGhpcy5wYWdlTnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXRQYWdlRXZlbnQocHJldlBhZ2VOdW1iZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIE51bWJlciBvZiBpdGVtcyB0byBkaXNwbGF5IG9uIGEgcGFnZS4gKkRlZmF1bHRzIHRvIDIwLiogKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBwYWdlU2l6ZSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZVNpemU7XG4gICAgfVxuICAgIHNldCBwYWdlU2l6ZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuX3BhZ2VTaXplID0gY29lcmNlTnVtYmVyUHJvcGVydHkodmFsdWUpO1xuICAgICAgICB0aGlzLl9wYWdlU2l6ZVVwZGF0ZWQoKTtcbiAgICAgICAgdGhpcy5wYWdlU2l6ZUNoYW5nZS5lbWl0KHRoaXMucGFnZVNpemUpO1xuICAgICAgICB0aGlzLl9lbWl0UGFnZUV2ZW50KHRoaXMucGFnZU51bWJlcik7XG4gICAgfVxuICAgIHByaXZhdGUgX3BhZ2VTaXplOiBudW1iZXIgPSBCYXNlUGFnaW5hdGlvbkNvbXBvbmVudC5fREVGQVVMVF9QQUdFX1NJWkU7XG5cbiAgICAvKiogRXZlbnQgZW1pdHRlZCB3aGVuIHRoZSBwYWdpbmF0b3IgY2hhbmdlcyB0aGUgcGFnZSBzaXplIG9yIHBhZ2UgaW5kZXguICovXG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgcGFnZTogRXZlbnRFbWl0dGVyPFBhZ2VFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPFBhZ2VFdmVudD4oKTtcblxuICAgIC8qKiBFbWl0cyB0aGUgbmV3IHBhZ2UgbnVtYmVyIHdoZW4gdGhlIHBhZ2UgbnVtYmVyIGNoYW5nZXMuICovXG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgcGFnZU51bWJlckNoYW5nZTogRXZlbnRFbWl0dGVyPG51bWJlcj4gPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcj4oKTtcbiAgICAvKiogRW1pdHMgdGhlIG5ldyBwYWdlIHNpemUgd2hlbiB0aGUgcGFnZSBzaXplIGNoYW5nZXMuICovXG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgcGFnZVNpemVDaGFuZ2U6IEV2ZW50RW1pdHRlcjxudW1iZXI+ID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5fbWFya0luaXRpYWxpemVkKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGNvbXB1dGVkIHRvdGFsIG51bWJlciBvZiBwYWdlc1xuICAgICAqL1xuICAgIGdldCB0b3RhbFBhZ2VzKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5fbGVuZ3RoIC8gdGhpcy5fcGFnZVNpemUpO1xuICAgIH1cblxuICAgIGdldCBfaXNGaXJzdFBhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYWdlTnVtYmVyID09PSAxO1xuICAgIH1cblxuICAgIGdldCBfaXNMYXN0UGFnZSgpIHtcbiAgICAgICAgcmV0dXJuICEhKHRoaXMudG90YWxQYWdlcyAmJiB0aGlzLl9wYWdlTnVtYmVyID09PSB0aGlzLnRvdGFsUGFnZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIHBhZ2Ugc2l6ZSBzbyB0aGF0IHRoZSBmaXJzdCBpdGVtIGRpc3BsYXllZCBvbiB0aGUgcGFnZSB3aWxsIHN0aWxsIGJlXG4gICAgICogZGlzcGxheWVkIHVzaW5nIHRoZSBuZXcgcGFnZSBzaXplLlxuICAgICAqXG4gICAgICogRm9yIGV4YW1wbGUsIGlmIHRoZSBwYWdlIHNpemUgaXMgMTAgYW5kIG9uIHRoZSBzZWNvbmQgcGFnZSAoaXRlbXMgaW5kZXhlZCAxMS0yMCkgdGhlblxuICAgICAqIHN3aXRjaGluZyBzbyB0aGF0IHRoZSBwYWdlIHNpemUgaXMgNSB3aWxsIHNldCB0aGUgdGhpcmQgcGFnZSBhcyB0aGUgY3VycmVudCBwYWdlIHNvXG4gICAgICogdGhhdCB0aGUgMTF0aCBpdGVtIHdpbGwgc3RpbGwgYmUgZGlzcGxheWVkLlxuICAgICAqL1xuICAgIF9jaGFuZ2VQYWdlU2l6ZShwYWdlU2l6ZTogbnVtYmVyKSB7XG4gICAgICAgIC8vIEN1cnJlbnQgcGFnZSBuZWVkcyB0byBiZSB1cGRhdGVkIHRvIHJlZmxlY3QgdGhlIG5ldyBwYWdlIHNpemUuIE5hdmlnYXRlIHRvIHRoZSBwYWdlXG4gICAgICAgIC8vIGNvbnRhaW5pbmcgdGhlIHByZXZpb3VzIHBhZ2UncyBmaXJzdCBpdGVtLlxuICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gKHRoaXMucGFnZU51bWJlciAtIDEpICogdGhpcy5wYWdlU2l6ZTtcbiAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHBhZ2VTaXplO1xuICAgICAgICB0aGlzLnBhZ2VOdW1iZXIgPSBNYXRoLmNlaWwoc3RhcnRJbmRleCAvIHBhZ2VTaXplKSArIDE7XG4gICAgfVxuXG4gICAgX3BhZ2VTaXplVXBkYXRlZCgpIHt9XG5cbiAgICBwcml2YXRlIF9zYW5pdGl6ZVBhZ2VOdW1iZXIocGFnZU51bWJlcjogYW55KTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgbnVtYmVyID0gTWF0aC5tYXgoY29lcmNlTnVtYmVyUHJvcGVydHkocGFnZU51bWJlciksIDEpO1xuICAgICAgICByZXR1cm4gbnVtYmVyID4gdGhpcy50b3RhbFBhZ2VzID8gdGhpcy50b3RhbFBhZ2VzIDogbnVtYmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2VtaXRQYWdlRXZlbnQocHJldmlvdXNQYWdlTnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5wYWdlLmVtaXQoe1xuICAgICAgICAgICAgcHJldmlvdXNQYWdlTnVtYmVyLFxuICAgICAgICAgICAgcGFnZU51bWJlcjogdGhpcy5wYWdlTnVtYmVyLFxuICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsXG4gICAgICAgICAgICBsZW5ndGg6IHRoaXMubGVuZ3RoXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==