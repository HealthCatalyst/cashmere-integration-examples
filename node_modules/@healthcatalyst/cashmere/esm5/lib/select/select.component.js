/**
 * @fileoverview added by tsickle
 * Generated from: lib/select/select.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, forwardRef, HostBinding, Input, ViewEncapsulation, ElementRef, Optional, Self, Output, EventEmitter, ContentChildren, QueryList, ViewChild } from '@angular/core';
import { NgForm, FormGroupDirective, NgControl } from '@angular/forms';
import { HcFormControlComponent } from '../form-field/hc-form-control.component';
import { parseBooleanAttribute } from '../util';
import { HcOptionDirective } from './hc-option.directive';
/** @type {?} */
var uniqueId = 1;
var SelectChangeEvent = /** @class */ (function () {
    function SelectChangeEvent(source, value) {
        this.source = source;
        this.value = value;
    }
    return SelectChangeEvent;
}());
export { SelectChangeEvent };
if (false) {
    /** @type {?} */
    SelectChangeEvent.prototype.source;
    /** @type {?} */
    SelectChangeEvent.prototype.value;
}
/**
 * Select one of many options from a dropdown
 */
var SelectComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SelectComponent, _super);
    function SelectComponent(_parentForm, _parentFormGroup, _ngControl) {
        var _this = _super.call(this) || this;
        _this._ngControl = _ngControl;
        _this._uniqueInputId = "hc-select-" + uniqueId++;
        _this._tight = false;
        _this._value = '';
        _this._componentId = _this._uniqueInputId;
        _this.focus = new EventEmitter();
        _this.blur = new EventEmitter();
        /**
         * Event emitted whenever the state changes
         */
        _this.change = new EventEmitter();
        _this._hostClass = true;
        _this.onChange = (/**
         * @return {?}
         */
        function () { });
        _this.onTouched = (/**
         * @return {?}
         */
        function () { });
        _this._form = _parentForm || _parentFormGroup;
        if (_this._ngControl != null) {
            _this._ngControl.valueAccessor = _this;
        }
        return _this;
    }
    Object.defineProperty(SelectComponent.prototype, "disabled", {
        /** Enables or disables the component */
        get: /**
         * Enables or disables the component
         * @return {?}
         */
        function () {
            if (this._ngControl && this._ngControl.disabled) {
                return this._ngControl.disabled;
            }
            return this._isDisabled;
        },
        set: /**
         * @param {?} disabledVal
         * @return {?}
         */
        function (disabledVal) {
            this._isDisabled = parseBooleanAttribute(disabledVal);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SelectComponent.prototype, "required", {
        /** Sets whether this is a required form element */
        get: /**
         * Sets whether this is a required form element
         * @return {?}
         */
        function () {
            return this._isRequired;
        },
        set: /**
         * @param {?} requiredVal
         * @return {?}
         */
        function (requiredVal) {
            this._isRequired = parseBooleanAttribute(requiredVal);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SelectComponent.prototype, "id", {
        /** Element id. */
        get: /**
         * Element id.
         * @return {?}
         */
        function () {
            return this._componentId || this._uniqueInputId;
        },
        set: /**
         * @param {?} idVal
         * @return {?}
         */
        function (idVal) {
            this._componentId = idVal ? idVal : this._uniqueInputId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SelectComponent.prototype, "value", {
        /** Get or set the value of the select component */
        get: /**
         * Get or set the value of the select component
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (val !== this._value) {
                this._value = val;
                this.onChange(val);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SelectComponent.prototype, "tight", {
        /** If true, condense the default margin and reduce the font size. *Defaults to `false`.*  */
        get: /**
         * If true, condense the default margin and reduce the font size. *Defaults to `false`.*
         * @return {?}
         */
        function () {
            return this._tight;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._tight = parseBooleanAttribute(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SelectComponent.prototype, "_disabledClass", {
        get: /**
         * @return {?}
         */
        function () {
            if (this._ngControl && this._ngControl.disabled) {
                return this._ngControl.disabled;
            }
            return this._isDisabled;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SelectComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this._valueData) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.writeValue(_this._valueData);
            }));
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    SelectComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    SelectComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    SelectComponent.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this._valueData = value;
        /** @type {?} */
        var targetVal = value;
        // If ngValue is being used, set the currently selected value based on that data
        if (this._options && this._options.length !== 0) {
            /** @type {?} */
            var selectedIndex_1 = 0;
            this._options.forEach((/**
             * @param {?} option
             * @param {?} index
             * @return {?}
             */
            function (option, index) {
                if (option.ngValue === value) {
                    selectedIndex_1 = index;
                }
            }));
            if (this.placeholder) {
                selectedIndex_1 += 1;
            }
            targetVal = this._nativeSelect.nativeElement.options[selectedIndex_1].value;
        }
        this._value = targetVal;
    };
    /**
     * @param {?} event
     * @param {?} value
     * @return {?}
     */
    SelectComponent.prototype._change = /**
     * @param {?} event
     * @param {?} value
     * @return {?}
     */
    function (event, value) {
        this._valueData = value;
        // If ngValue is being used, pull that value from the directive to allow objects well as strings
        if (this._options.length !== 0) {
            /** @type {?} */
            var optionArray = this._options.toArray();
            /** @type {?} */
            var index = this.placeholder
                ? this._nativeSelect.nativeElement.selectedIndex - 1
                : this._nativeSelect.nativeElement.selectedIndex;
            this._valueData = optionArray[index].ngValue;
        }
        event.stopPropagation();
        this._value = value;
        this.onChange(this._valueData);
        this.change.emit(new SelectChangeEvent(this, this._valueData));
    };
    /**
     * @return {?}
     */
    SelectComponent.prototype.ngDoCheck = /**
     * @return {?}
     */
    function () {
        // This needs to be checked every cycle because we can't subscribe to form submissions
        if (this._ngControl) {
            this._updateErrorState();
        }
    };
    /**
     * @private
     * @return {?}
     */
    SelectComponent.prototype._updateErrorState = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var oldState = this._errorState;
        // TODO: this could be abstracted out as an @Input() if we need this to be configurable
        /** @type {?} */
        var newState = !!(this._ngControl &&
            this._ngControl.invalid &&
            (this._ngControl.touched || (this._form && this._form.submitted)));
        if (oldState !== newState) {
            this._errorState = newState;
        }
    };
    SelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'hc-select',
                    template: "<div class=\"hc-select-container\" [class.hc-select-tight]=\"tight\">\n    <span class=\"hc-select-chevron\"></span>\n    <select\n        #selectInput\n        class=\"hc-select-input\"\n        [disabled]=\"disabled\"\n        (change)=\"_change($event, selectInput.value)\"\n        [value]=\"value\"\n        (focus)=\"focus.next()\"\n        (blur)=\"blur.next()\"\n        [required]=\"required\"\n    >\n        <option *ngIf=\"placeholder\" value=\"\" selected disabled hidden>{{ placeholder }}</option>\n        <ng-content></ng-content>\n    </select>\n</div>\n",
                    encapsulation: ViewEncapsulation.None,
                    providers: [{ provide: HcFormControlComponent, useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return SelectComponent; })) }],
                    styles: [".hc-select{display:inline-block;width:100%}.hc-select-container{position:relative}.hc-select-container select:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}@-moz-document url-prefix(){.hc-select-container select:focus{outline:#6d6e70 dotted 1px;outline-offset:-3px}}.hc-select-chevron{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;height:35px;-webkit-box-pack:center;justify-content:center;line-height:35px;pointer-events:none;position:absolute;right:0;text-align:center;top:0;width:35px}.hc-select-chevron:after{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNi45NzgiIGhlaWdodD0iMTcuMzE5IiB2aWV3Qm94PSIwIDAgMjYuOTc4IDE3LjMxOSI+CiAgPGRlZnM+CiAgICA8c3R5bGU+CiAgICAgIC5jbHMtMSB7CiAgICAgICAgZmlsbDogIzAwYWVmZjsKICAgICAgfQogICAgPC9zdHlsZT4KICA8L2RlZnM+CiAgPHBhdGggaWQ9IlBhdGhfNSIgZGF0YS1uYW1lPSJQYXRoIDUiIGNsYXNzPSJjbHMtMSIgZD0iTTI4LjE3NS0xMi4xODhhMS4wODEsMS4wODEsMCwwLDAsMC0xLjUyM0wyNS40LTE2LjQ3M2ExLjA2MSwxLjA2MSwwLDAsMC0xLjUwNywwTDE1LTcuNTg0bC04Ljg5LTguODlhMS4wNjEsMS4wNjEsMCwwLDAtMS41MDcsMEwxLjgyNS0xMy43MTFhMS4wODEsMS4wODEsMCwwLDAsMCwxLjUyM0wxNC4yNDcuMjE4YTEuMDYxLDEuMDYxLDAsMCwwLDEuNTA3LDBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMS41MTEgMTYuNzg3KSIvPgo8L3N2Zz4K);background-repeat:no-repeat;background-size:contain;box-sizing:border-box;content:'';height:8.5px;margin-top:2px;pointer-events:none;width:13px}.hc-select-disabled .hc-select-chevron{opacity:.4}.hc-select-tight .hc-select-chevron{height:28px}.hc-select-input{font-size:1rem;-webkit-appearance:none;-moz-appearance:none;background-color:#fff;border:1px solid #ccc;box-shadow:inset .5px .5px 0 #ccc,inset -.5px -.5px 0 #ccc;border-radius:0;color:#333;cursor:pointer;font:inherit;height:35px;line-height:1.3;padding-left:9px;padding-right:32px;width:100%}.hc-select-input::-ms-expand{display:none}.hc-select-input[disabled]{background-color:#f0f3f6;border:1px solid #e0e0e0;box-shadow:inset .5px .5px 0 #e0e0e0,inset -.5px -.5px 0 #e0e0e0;color:#adadad;cursor:not-allowed}.hc-form-field-invalid .hc-select-input{border:1px solid #cc2027;box-shadow:inset .5px .5px 0 #cc2027,inset -.5px -.5px 0 #cc2027}.hc-select-tight .hc-select-input{font-size:.92857rem;height:28px}@media all and (-ms-high-contrast:none){.hc-select-input,.hc-select-input-invalid,.hc-select-input[disabled]{border-width:2px;box-shadow:none}}"]
                }] }
    ];
    /** @nocollapse */
    SelectComponent.ctorParameters = function () { return [
        { type: NgForm, decorators: [{ type: Optional }] },
        { type: FormGroupDirective, decorators: [{ type: Optional }] },
        { type: NgControl, decorators: [{ type: Optional }, { type: Self }] }
    ]; };
    SelectComponent.propDecorators = {
        _options: [{ type: ContentChildren, args: [HcOptionDirective,] }],
        _nativeSelect: [{ type: ViewChild, args: ['selectInput', { static: false },] }],
        placeholder: [{ type: Input }],
        disabled: [{ type: Input }],
        required: [{ type: Input }],
        id: [{ type: Input }],
        value: [{ type: Input }],
        tight: [{ type: Input }],
        focus: [{ type: Output }],
        blur: [{ type: Output }],
        change: [{ type: Output }],
        _hostClass: [{ type: HostBinding, args: ['class.hc-select',] }],
        _disabledClass: [{ type: HostBinding, args: ['class.hc-select-disabled',] }]
    };
    return SelectComponent;
}(HcFormControlComponent));
export { SelectComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._uniqueInputId;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._form;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._tight;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._value;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._valueData;
    /** @type {?} */
    SelectComponent.prototype._componentId;
    /** @type {?} */
    SelectComponent.prototype._options;
    /** @type {?} */
    SelectComponent.prototype._nativeSelect;
    /**
     * Optional string of text to appear before selection is made
     * @type {?}
     */
    SelectComponent.prototype.placeholder;
    /** @type {?} */
    SelectComponent.prototype.focus;
    /** @type {?} */
    SelectComponent.prototype.blur;
    /**
     * Event emitted whenever the state changes
     * @type {?}
     */
    SelectComponent.prototype.change;
    /** @type {?} */
    SelectComponent.prototype._hostClass;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype.onTouched;
    /** @type {?} */
    SelectComponent.prototype._ngControl;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BoZWFsdGhjYXRhbHlzdC9jYXNobWVyZS8iLCJzb3VyY2VzIjpbImxpYi9zZWxlY3Qvc2VsZWN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUNULFVBQVUsRUFDVixXQUFXLEVBQ1gsS0FBSyxFQUNMLGlCQUFpQixFQUNqQixVQUFVLEVBQ1YsUUFBUSxFQUVSLElBQUksRUFDSixNQUFNLEVBQ04sWUFBWSxFQUNaLGVBQWUsRUFDZixTQUFTLEVBQ1QsU0FBUyxFQUVaLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBdUIsTUFBTSxFQUFFLGtCQUFrQixFQUFFLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzNGLE9BQU8sRUFBQyxzQkFBc0IsRUFBQyxNQUFNLHlDQUF5QyxDQUFDO0FBQy9FLE9BQU8sRUFBQyxxQkFBcUIsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUM5QyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQzs7SUFFcEQsUUFBUSxHQUFHLENBQUM7QUFFaEI7SUFDSSwyQkFBbUIsTUFBdUIsRUFBUyxLQUFVO1FBQTFDLFdBQU0sR0FBTixNQUFNLENBQWlCO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBSztJQUFHLENBQUM7SUFDckUsd0JBQUM7QUFBRCxDQUFDLEFBRkQsSUFFQzs7OztJQURlLG1DQUE4Qjs7SUFBRSxrQ0FBaUI7Ozs7O0FBSWpFO0lBT3FDLDJDQUFzQjtJQThGdkQseUJBQ2dCLFdBQW1CLEVBQ25CLGdCQUFvQyxFQUd6QyxVQUFxQjtRQUxoQyxZQU9JLGlCQUFPLFNBTVY7UUFSVSxnQkFBVSxHQUFWLFVBQVUsQ0FBVztRQWxHeEIsb0JBQWMsR0FBRyxlQUFhLFFBQVEsRUFBSSxDQUFDO1FBRTNDLFlBQU0sR0FBWSxLQUFLLENBQUM7UUFDeEIsWUFBTSxHQUFRLEVB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bnQsXG4gICAgZm9yd2FyZFJlZixcbiAgICBIb3N0QmluZGluZyxcbiAgICBJbnB1dCxcbiAgICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgICBFbGVtZW50UmVmLFxuICAgIE9wdGlvbmFsLFxuICAgIERvQ2hlY2ssXG4gICAgU2VsZixcbiAgICBPdXRwdXQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIENvbnRlbnRDaGlsZHJlbixcbiAgICBRdWVyeUxpc3QsXG4gICAgVmlld0NoaWxkLFxuICAgIEFmdGVyQ29udGVudEluaXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0Zvcm0sIEZvcm1Hcm91cERpcmVjdGl2ZSwgTmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0hjRm9ybUNvbnRyb2xDb21wb25lbnR9IGZyb20gJy4uL2Zvcm0tZmllbGQvaGMtZm9ybS1jb250cm9sLmNvbXBvbmVudCc7XG5pbXBvcnQge3BhcnNlQm9vbGVhbkF0dHJpYnV0ZX0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQge0hjT3B0aW9uRGlyZWN0aXZlfSBmcm9tICcuL2hjLW9wdGlvbi5kaXJlY3RpdmUnO1xuXG5sZXQgdW5pcXVlSWQgPSAxO1xuXG5leHBvcnQgY2xhc3MgU2VsZWN0Q2hhbmdlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzb3VyY2U6IFNlbGVjdENvbXBvbmVudCwgcHVibGljIHZhbHVlOiBhbnkpIHt9XG59XG5cbi8qKiBTZWxlY3Qgb25lIG9mIG1hbnkgb3B0aW9ucyBmcm9tIGEgZHJvcGRvd24gKi9cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnaGMtc2VsZWN0JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3NlbGVjdC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ3NlbGVjdC5jb21wb25lbnQuc2NzcyddLFxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gICAgcHJvdmlkZXJzOiBbe3Byb3ZpZGU6IEhjRm9ybUNvbnRyb2xDb21wb25lbnQsIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFNlbGVjdENvbXBvbmVudCl9XVxufSlcbmV4cG9ydCBjbGFzcyBTZWxlY3RDb21wb25lbnQgZXh0ZW5kcyBIY0Zvcm1Db250cm9sQ29tcG9uZW50IGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIEFmdGVyQ29udGVudEluaXQsIERvQ2hlY2sge1xuICAgIHByaXZhdGUgX3VuaXF1ZUlucHV0SWQgPSBgaGMtc2VsZWN0LSR7dW5pcXVlSWQrK31gO1xuICAgIHByaXZhdGUgX2Zvcm06IE5nRm9ybSB8IEZvcm1Hcm91cERpcmVjdGl2ZSB8IG51bGw7XG4gICAgcHJpdmF0ZSBfdGlnaHQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIF92YWx1ZTogYW55ID0gJyc7XG4gICAgcHJpdmF0ZSBfdmFsdWVEYXRhOiBhbnk7XG5cbiAgICBfY29tcG9uZW50SWQgPSB0aGlzLl91bmlxdWVJbnB1dElkO1xuXG4gICAgQENvbnRlbnRDaGlsZHJlbihIY09wdGlvbkRpcmVjdGl2ZSlcbiAgICBfb3B0aW9uczogUXVlcnlMaXN0PEhjT3B0aW9uRGlyZWN0aXZlPjtcblxuICAgIEBWaWV3Q2hpbGQoJ3NlbGVjdElucHV0Jywge3N0YXRpYzogZmFsc2V9KVxuICAgIF9uYXRpdmVTZWxlY3Q6IEVsZW1lbnRSZWY7XG5cbiAgICAvKiogT3B0aW9uYWwgc3RyaW5nIG9mIHRleHQgdG8gYXBwZWFyIGJlZm9yZSBzZWxlY3Rpb24gaXMgbWFkZSAqL1xuICAgIEBJbnB1dCgpXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcblxuICAgIC8qKiBFbmFibGVzIG9yIGRpc2FibGVzIHRoZSBjb21wb25lbnQgKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuX25nQ29udHJvbCAmJiB0aGlzLl9uZ0NvbnRyb2wuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uZ0NvbnRyb2wuZGlzYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRGlzYWJsZWQ7XG4gICAgfVxuXG4gICAgc2V0IGRpc2FibGVkKGRpc2FibGVkVmFsKSB7XG4gICAgICAgIHRoaXMuX2lzRGlzYWJsZWQgPSBwYXJzZUJvb2xlYW5BdHRyaWJ1dGUoZGlzYWJsZWRWYWwpO1xuICAgIH1cblxuICAgIC8qKiBTZXRzIHdoZXRoZXIgdGhpcyBpcyBhIHJlcXVpcmVkIGZvcm0gZWxlbWVudCAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IHJlcXVpcmVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNSZXF1aXJlZDtcbiAgICB9XG5cbiAgICBzZXQgcmVxdWlyZWQocmVxdWlyZWRWYWwpIHtcbiAgICAgICAgdGhpcy5faXNSZXF1aXJlZCA9IHBhcnNlQm9vbGVhbkF0dHJpYnV0ZShyZXF1aXJlZFZhbCk7XG4gICAgfVxuXG4gICAgLyoqIEVsZW1lbnQgaWQuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBvbmVudElkIHx8IHRoaXMuX3VuaXF1ZUlucHV0SWQ7XG4gICAgfVxuXG4gICAgc2V0IGlkKGlkVmFsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50SWQgPSBpZFZhbCA/IGlkVmFsIDogdGhpcy5fdW5pcXVlSW5wdXRJZDtcbiAgICB9XG5cbiAgICAvKiogR2V0IG9yIHNldCB0aGUgdmFsdWUgb2YgdGhlIHNlbGVjdCBjb21wb25lbnQgKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cblxuICAgIHNldCB2YWx1ZSh2YWw6IGFueSkge1xuICAgICAgICBpZiAodmFsICE9PSB0aGlzLl92YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWw7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKHZhbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogSWYgdHJ1ZSwgY29uZGVuc2UgdGhlIGRlZmF1bHQgbWFyZ2luIGFuZCByZWR1Y2UgdGhlIGZvbnQgc2l6ZS4gKkRlZmF1bHRzIHRvIGBmYWxzZWAuKiAgKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCB0aWdodCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpZ2h0O1xuICAgIH1cbiAgICBzZXQgdGlnaHQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdGlnaHQgPSBwYXJzZUJvb2xlYW5BdHRyaWJ1dGUodmFsdWUpO1xuICAgIH1cblxuICAgIEBPdXRwdXQoKVxuICAgIHJlYWRvbmx5IGZvY3VzOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgYmx1cjogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gICAgLyoqIEV2ZW50IGVtaXR0ZWQgd2hlbmV2ZXIgdGhlIHN0YXRlIGNoYW5nZXMgKi9cbiAgICBAT3V0cHV0KClcbiAgICBjaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPFNlbGVjdENoYW5nZUV2ZW50PigpO1xuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYy1zZWxlY3QnKVxuICAgIF9ob3N0Q2xhc3MgPSB0cnVlO1xuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYy1zZWxlY3QtZGlzYWJsZWQnKVxuICAgIGdldCBfZGlzYWJsZWRDbGFzcygpIHtcbiAgICAgICAgaWYgKHRoaXMuX25nQ29udHJvbCAmJiB0aGlzLl9uZ0NvbnRyb2wuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uZ0NvbnRyb2wuZGlzYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRGlzYWJsZWQ7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIEBPcHRpb25hbCgpIF9wYXJlbnRGb3JtOiBOZ0Zvcm0sXG4gICAgICAgIEBPcHRpb25hbCgpIF9wYXJlbnRGb3JtR3JvdXA6IEZvcm1Hcm91cERpcmVjdGl2ZSxcbiAgICAgICAgQE9wdGlvbmFsKClcbiAgICAgICAgQFNlbGYoKVxuICAgICAgICBwdWJsaWMgX25nQ29udHJvbDogTmdDb250cm9sXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5fZm9ybSA9IF9wYXJlbnRGb3JtIHx8IF9wYXJlbnRGb3JtR3JvdXA7XG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fbmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgICAgICBpZiAodGhpcy5fdmFsdWVEYXRhKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRlVmFsdWUodGhpcy5fdmFsdWVEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkNoYW5nZTogKHZhbDogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG5cbiAgICBwcml2YXRlIG9uVG91Y2hlZDogKHZhbDogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG5cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgICB9XG5cbiAgICB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5fdmFsdWVEYXRhID0gdmFsdWU7XG4gICAgICAgIGxldCB0YXJnZXRWYWwgPSB2YWx1ZTtcbiAgICAgICAgLy8gSWYgbmdWYWx1ZSBpcyBiZWluZyB1c2VkLCBzZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB2YWx1ZSBiYXNlZCBvbiB0aGF0IGRhdGFcbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMgJiYgdGhpcy5fb3B0aW9ucy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGxldCBzZWxlY3RlZEluZGV4OiBudW1iZXIgPSAwO1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbi5uZ1ZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5wbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldFZhbCA9IHRoaXMuX25hdGl2ZVNlbGVjdC5uYXRpdmVFbGVtZW50Lm9wdGlvbnNbc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmFsdWUgPSB0YXJnZXRWYWw7XG4gICAgfVxuXG4gICAgX2NoYW5nZShldmVudDogRXZlbnQsIHZhbHVlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5fdmFsdWVEYXRhID0gdmFsdWU7XG4gICAgICAgIC8vIElmIG5nVmFsdWUgaXMgYmVpbmcgdXNlZCwgcHVsbCB0aGF0IHZhbHVlIGZyb20gdGhlIGRpcmVjdGl2ZSB0byBhbGxvdyBvYmplY3RzIHdlbGwgYXMgc3RyaW5nc1xuICAgICAgICBpZiAodGhpcy5fb3B0aW9ucy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbkFycmF5ID0gdGhpcy5fb3B0aW9ucy50b0FycmF5KCk7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICA/IHRoaXMuX25hdGl2ZVNlbGVjdC5uYXRpdmVFbGVtZW50LnNlbGVjdGVkSW5kZXggLSAxXG4gICAgICAgICAgICAgICAgOiB0aGlzLl9uYXRpdmVTZWxlY3QubmF0aXZlRWxlbWVudC5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgdGhpcy5fdmFsdWVEYXRhID0gb3B0aW9uQXJyYXlbaW5kZXhdLm5nVmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5vbkNoYW5nZSh0aGlzLl92YWx1ZURhdGEpO1xuICAgICAgICB0aGlzLmNoYW5nZS5lbWl0KG5ldyBTZWxlY3RDaGFuZ2VFdmVudCh0aGlzLCB0aGlzLl92YWx1ZURhdGEpKTtcbiAgICB9XG5cbiAgICBuZ0RvQ2hlY2soKTogdm9pZCB7XG4gICAgICAgIC8vIFRoaXMgbmVlZHMgdG8gYmUgY2hlY2tlZCBldmVyeSBjeWNsZSBiZWNhdXNlIHdlIGNhbid0IHN1YnNjcmliZSB0byBmb3JtIHN1Ym1pc3Npb25zXG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUVycm9yU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgX3VwZGF0ZUVycm9yU3RhdGUoKSB7XG4gICAgICAgIGNvbnN0IG9sZFN0YXRlID0gdGhpcy5fZXJyb3JTdGF0ZTtcblxuICAgICAgICAvLyBUT0RPOiB0aGlzIGNvdWxkIGJlIGFic3RyYWN0ZWQgb3V0IGFzIGFuIEBJbnB1dCgpIGlmIHdlIG5lZWQgdGhpcyB0byBiZSBjb25maWd1cmFibGVcbiAgICAgICAgY29uc3QgbmV3U3RhdGUgPSAhIShcbiAgICAgICAgICAgIHRoaXMuX25nQ29udHJvbCAmJlxuICAgICAgICAgICAgdGhpcy5fbmdDb250cm9sLmludmFsaWQgJiZcbiAgICAgICAgICAgICh0aGlzLl9uZ0NvbnRyb2wudG91Y2hlZCB8fCAodGhpcy5fZm9ybSAmJiB0aGlzLl9mb3JtLnN1Ym1pdHRlZCkpXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKG9sZFN0YXRlICE9PSBuZXdTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5fZXJyb3JTdGF0ZSA9IG5ld1N0YXRlO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19