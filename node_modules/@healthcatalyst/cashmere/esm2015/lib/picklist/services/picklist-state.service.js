/**
 * @fileoverview added by tsickle
 * Generated from: lib/picklist/services/picklist-state.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { PicklistOptionsSource, PicklistSettings } from '../picklist.model';
import { FilterableSelectList, ValueListOption, ValueSetListOption } from '../pane/picklist-pane.model';
import { PicklistFilterLocalService } from './picklist-filter-local.service';
export class PicklistStateService {
    /**
     * @param {?} localFilterService
     */
    constructor(localFilterService) {
        this.localFilterService = localFilterService;
        this.picklist = new PicklistSettings();
        this.optionsSource = new PicklistOptionsSource();
        this.valueList = new FilterableSelectList();
        this.valueSetList = new FilterableSelectList();
    }
    /**
     * @param {?} settings
     * @param {?} optionsSource
     * @param {?} pane
     * @return {?}
     */
    reset(settings, optionsSource, pane) {
        this.picklist = settings;
        this.pane = pane;
        this.optionsSource = optionsSource;
        this.clearList(this.valueList);
        this.clearList(this.valueSetList);
    }
    /**
     * @param {?} options
     * @param {?=} searchTokens
     * @return {?}
     */
    updateValueList(options, searchTokens = []) {
        /** @type {?} */
        const listOptions = options.map((/**
         * @param {?} v
         * @return {?}
         */
        v => new ValueListOption(v, v.code)));
        /** @type {?} */
        const companionList = this.pane.companion ? this.pane.companion.valueList : null;
        this.valueList.sort = this.picklist.sort;
        this.updateList(listOptions, this.valueList, companionList, searchTokens);
    }
    /**
     * @param {?} options
     * @param {?=} searchTokens
     * @return {?}
     */
    updateValueSetList(options, searchTokens = []) {
        /** @type {?} */
        const listOptions = new Array();
        /** @type {?} */
        const companionList = this.pane.companion ? this.pane.companion.valueSetList : null;
        options.forEach((/**
         * @param {?} v
         * @return {?}
         */
        v => {
            /** @type {?} */
            const listOption = new ValueSetListOption(v, v.code);
            if (v.subValues && v.subValues.length > 0) {
                /** @type {?} */
                const subValueListOptions = v.subValues.map((/**
                 * @param {?} sv
                 * @return {?}
                 */
                (sv) => new ValueListOption(sv, sv.code)));
                this.updateList(subValueListOptions, listOption.subValuesSelectList, null, searchTokens);
            }
            listOptions.push(listOption);
        }));
        this.updateList(listOptions, this.valueSetList, companionList, searchTokens);
    }
    /**
     * @template T
     * @param {?} list
     * @return {?}
     */
    clearList(list) {
        list.options.clear();
        list.filteredOptions.length = 0;
        list.selectedOptions.clear();
        list.lastClickedOption = null;
        list.additionalRemoteOptions = 0;
    }
    /**
     * @private
     * @template T
     * @param {?} options
     * @param {?} list
     * @param {?=} companionList
     * @param {?=} searchTokens
     * @return {?}
     */
    updateList(options, list, companionList = null, searchTokens = []) {
        if (!this.optionsSource.isPaged && this.pane.shouldExcludeCompanion && companionList) {
            options = options.filter((/**
             * @param {?} o
             * @return {?}
             */
            o => !companionList.options.get(o.code)));
        }
        options.forEach((/**
         * @param {?} o
         * @return {?}
         */
        o => {
            list.options.set(o.code, o);
            list.filteredOptions.push(o);
        }));
        this.localFilterService.filter(list, searchTokens);
    }
}
PicklistStateService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
PicklistStateService.ctorParameters = () => [
    { type: PicklistFilterLocalService }
];
if (false) {
    /** @type {?} */
    PicklistStateService.prototype.pane;
    /** @type {?} */
    PicklistStateService.prototype.picklist;
    /** @type {?} */
    PicklistStateService.prototype.optionsSource;
    /** @type {?} */
    PicklistStateService.prototype.valueList;
    /** @type {?} */
    PicklistStateService.prototype.valueSetList;
    /**
     * @type {?}
     * @private
     */
    PicklistStateService.prototype.localFilterService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGlja2xpc3Qtc3RhdGUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BoZWFsdGhjYXRhbHlzdC9jYXNobWVyZS8iLCJzb3VyY2VzIjpbImxpYi9waWNrbGlzdC9zZXJ2aWNlcy9waWNrbGlzdC1zdGF0ZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUV6QyxPQUFPLEVBQWdDLHFCQUFxQixFQUFFLGdCQUFnQixFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDekcsT0FBTyxFQUFDLG9CQUFvQixFQUFvQixlQUFlLEVBQUUsa0JBQWtCLEVBQUMsTUFBTSw2QkFBNkIsQ0FBQztBQUV4SCxPQUFPLEVBQUMsMEJBQTBCLEVBQUMsTUFBTSxpQ0FBaUMsQ0FBQztBQUczRSxNQUFNLE9BQU8sb0JBQW9COzs7O0lBTzdCLFlBQTJCLGtCQUE4QztRQUE5Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQTRCO1FBTGxFLGFBQVEsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUM7UUFDbEMsa0JBQWEsR0FBRyxJQUFJLHFCQUFxQixFQUFFLENBQUM7UUFDNUMsY0FBUyxHQUFHLElBQUksb0JBQW9CLEVBQW1CLENBQUM7UUFDeEQsaUJBQVksR0FBRyxJQUFJLG9CQUFvQixFQUFzQixDQUFDO0lBRU8sQ0FBQzs7Ozs7OztJQUV0RSxLQUFLLENBQUMsUUFBMEIsRUFBRSxhQUFvQyxFQUFFLElBQTJCO1FBQ3RHLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1FBQ25DLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQy9CLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lB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SSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQzVCLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsRUFBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDdkQsQ0FBQzs7O1lBN0RKLFVBQVU7Ozs7WUFGSCwwQkFBMEI7Ozs7SUFJOUIsb0NBQW1DOztJQUNuQyx3Q0FBeUM7O0lBQ3pDLDZDQUFtRDs7SUFDbkQseUNBQStEOztJQUMvRCw0Q0FBcUU7Ozs7O0lBRWxELGtEQUFzRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7SVZhbHVlT3B0aW9uLCBJVmFsdWVTZXRPcHRpb24sIFBpY2tsaXN0T3B0aW9uc1NvdXJjZSwgUGlja2xpc3RTZXR0aW5nc30gZnJvbSAnLi4vcGlja2xpc3QubW9kZWwnO1xuaW1wb3J0IHtGaWx0ZXJhYmxlU2VsZWN0TGlzdCwgU2VsZWN0TGlzdE9wdGlvbiwgVmFsdWVMaXN0T3B0aW9uLCBWYWx1ZVNldExpc3RPcHRpb259IGZyb20gJy4uL3BhbmUvcGlja2xpc3QtcGFuZS5tb2RlbCc7XG5pbXBvcnQge1BpY2tsaXN0UGFuZUNvbXBvbmVudH0gZnJvbSAnLi4vcGFuZS9waWNrbGlzdC1wYW5lLmNvbXBvbmVudCc7XG5pbXBvcnQge1BpY2tsaXN0RmlsdGVyTG9jYWxTZXJ2aWNlfSBmcm9tICcuL3BpY2tsaXN0LWZpbHRlci1sb2NhbC5zZXJ2aWNlJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFBpY2tsaXN0U3RhdGVTZXJ2aWNlIHtcbiAgICBwdWJsaWMgcGFuZTogUGlja2xpc3RQYW5lQ29tcG9uZW50O1xuICAgIHB1YmxpYyBwaWNrbGlzdCA9IG5ldyBQaWNrbGlzdFNldHRpbmdzKCk7XG4gICAgcHVibGljIG9wdGlvbnNTb3VyY2UgPSBuZXcgUGlja2xpc3RPcHRpb25zU291cmNlKCk7XG4gICAgcHVibGljIHZhbHVlTGlzdCA9IG5ldyBGaWx0ZXJhYmxlU2VsZWN0TGlzdDxWYWx1ZUxpc3RPcHRpb24+KCk7XG4gICAgcHVibGljIHZhbHVlU2V0TGlzdCA9IG5ldyBGaWx0ZXJhYmxlU2VsZWN0TGlzdDxWYWx1ZVNldExpc3RPcHRpb24+KCk7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSBsb2NhbEZpbHRlclNlcnZpY2U6IFBpY2tsaXN0RmlsdGVyTG9jYWxTZXJ2aWNlKSB7fVxuXG4gICAgcHVibGljIHJlc2V0KHNldHRpbmdzOiBQaWNrbGlzdFNldHRpbmdzLCBvcHRpb25zU291cmNlOiBQaWNrbGlzdE9wdGlvbnNTb3VyY2UsIHBhbmU6IFBpY2tsaXN0UGFuZUNvbXBvbmVudCkge1xuICAgICAgICB0aGlzLnBpY2tsaXN0ID0gc2V0dGluZ3M7XG4gICAgICAgIHRoaXMucGFuZSA9IHBhbmU7XG4gICAgICAgIHRoaXMub3B0aW9uc1NvdXJjZSA9IG9wdGlvbnNTb3VyY2U7XG4gICAgICAgIHRoaXMuY2xlYXJMaXN0KHRoaXMudmFsdWVMaXN0KTtcbiAgICAgICAgdGhpcy5jbGVhckxpc3QodGhpcy52YWx1ZVNldExpc3QpO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGVWYWx1ZUxpc3Qob3B0aW9uczogSVZhbHVlT3B0aW9uW10sIHNlYXJjaFRva2Vuczogc3RyaW5nW10gPSBbXSkge1xuICAgICAgICBjb25zdCBsaXN0T3B0aW9ucyA9IG9wdGlvbnMubWFwKHYgPT4gbmV3IFZhbHVlTGlzdE9wdGlvbih2LCB2LmNvZGUpKTtcbiAgICAgICAgY29uc3QgY29tcGFuaW9uTGlzdCA9IHRoaXMucGFuZS5jb21wYW5pb24gPyB0aGlzLnBhbmUuY29tcGFuaW9uLnZhbHVlTGlzdCA6IG51bGw7XG4gICAgICAgIHRoaXMudmFsdWVMaXN0LnNvcnQgPSB0aGlzLnBpY2tsaXN0LnNvcnQ7XG4gICAgICAgIHRoaXMudXBkYXRlTGlzdChsaXN0T3B0aW9ucywgdGhpcy52YWx1ZUxpc3QsIGNvbXBhbmlvbkxpc3QsIHNlYXJjaFRva2Vucyk7XG4gICAgfVxuXG4gICAgcHVibGljIHVwZGF0ZVZhbHVlU2V0TGlzdChvcHRpb25zOiBJVmFsdWVTZXRPcHRpb25bXSwgc2VhcmNoVG9rZW5zOiBzdHJpbmdbXSA9IFtdKSB7XG4gICAgICAgIGNvbnN0IGxpc3RPcHRpb25zID0gbmV3IEFycmF5PFZhbHVlU2V0TGlzdE9wdGlvbj4oKTtcbiAgICAgICAgY29uc3QgY29tcGFuaW9uTGlzdCA9IHRoaXMucGFuZS5jb21wYW5pb24gPyB0aGlzLnBhbmUuY29tcGFuaW9uLnZhbHVlU2V0TGlzdCA6IG51bGw7XG4gICAgICAgIG9wdGlvbnMuZm9yRWFjaCh2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RPcHRpb24gPSBuZXcgVmFsdWVTZXRMaXN0T3B0aW9uKHYsIHYuY29kZSk7XG4gICAgICAgICAgICBpZiAodi5zdWJWYWx1ZXMgJiYgdi5zdWJWYWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1YlZhbHVlTGlzdE9wdGlvbnMgPSB2LnN1YlZhbHVlcy5tYXAoKHN2OiBJVmFsdWVPcHRpb24pID0+IG5ldyBWYWx1ZUxpc3RPcHRpb24oc3YsIHN2LmNvZGUpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUxpc3Qoc3ViVmFsdWVMaXN0T3B0aW9ucywgbGlzdE9wdGlvbi5zdWJWYWx1ZXNTZWxlY3RMaXN0LCBudWxsLCBzZWFyY2hUb2tlbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGlzdE9wdGlvbnMucHVzaChsaXN0T3B0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBkYXRlTGlzdChsaXN0T3B0aW9ucywgdGhpcy52YWx1ZVNldExpc3QsIGNvbXBhbmlvbkxpc3QsIHNlYXJjaFRva2Vucyk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyTGlzdDxUIGV4dGVuZHMgU2VsZWN0TGlzdE9wdGlvbj4obGlzdDogRmlsdGVyYWJsZVNlbGVjdExpc3Q8VD4pIHtcbiAgICAgICAgbGlzdC5vcHRpb25zLmNsZWFyKCk7XG4gICAgICAgIGxpc3QuZmlsdGVyZWRPcHRpb25zLmxlbmd0aCA9IDA7XG4gICAgICAgIGxpc3Quc2VsZWN0ZWRPcHRpb25zLmNsZWFyKCk7XG4gICAgICAgIGxpc3QubGFzdENsaWNrZWRPcHRpb24gPSBudWxsO1xuICAgICAgICBsaXN0LmFkZGl0aW9uYWxSZW1vdGVPcHRpb25zID0gMDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUxpc3Q8VCBleHRlbmRzIFNlbGVjdExpc3RPcHRpb24+KFxuICAgICAgICBvcHRpb25zOiBUW10sXG4gICAgICAgIGxpc3Q6IEZpbHRlcmFibGVTZWxlY3RMaXN0PFQ+LFxuICAgICAgICBjb21wYW5pb25MaXN0OiBGaWx0ZXJhYmxlU2VsZWN0TGlzdDxUPiB8IG51bGwgPSBudWxsLFxuICAgICAgICBzZWFyY2hUb2tlbnM6IHN0cmluZ1tdID0gW11cbiAgICApIHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnNTb3VyY2UuaXNQYWdlZCAmJiB0aGlzLnBhbmUuc2hvdWxkRXhjbHVkZUNvbXBhbmlvbiAmJiBjb21wYW5pb25MaXN0KSB7XG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucy5maWx0ZXIobyA9PiAhY29tcGFuaW9uTGlzdC5vcHRpb25zLmdldChvLmNvZGUpKTtcbiAgICAgICAgfVxuICAgICAgICBvcHRpb25zLmZvckVhY2gobyA9PiB7XG4gICAgICAgICAgICBsaXN0Lm9wdGlvbnMuc2V0KG8uY29kZSwgbyk7XG4gICAgICAgICAgICBsaXN0LmZpbHRlcmVkT3B0aW9ucy5wdXNoKG8pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sb2NhbEZpbHRlclNlcnZpY2UuZmlsdGVyKGxpc3QsIHNlYXJjaFRva2Vucyk7XG4gICAgfVxufVxuIl19