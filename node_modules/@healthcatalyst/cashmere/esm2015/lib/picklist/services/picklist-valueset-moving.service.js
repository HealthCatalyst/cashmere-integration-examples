/**
 * @fileoverview added by tsickle
 * Generated from: lib/picklist/services/picklist-valueset-moving.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { PicklistFilterService } from './picklist-filter.service';
import { ValueListOption } from '../pane/picklist-pane.model';
import { PicklistStateService } from './picklist-state.service';
export class PicklistValuesetMovingService {
    /**
     * @param {?} filterService
     * @param {?} stateService
     */
    constructor(filterService, stateService) {
        this.filterService = filterService;
        this.stateService = stateService;
    }
    /**
     * @return {?}
     */
    get valueList() {
        return this.stateService.valueList;
    }
    /**
     * @return {?}
     */
    get valueSetList() {
        return this.stateService.valueSetList;
    }
    /**
     * @param {?} optionsToMove
     * @param {?} pane
     * @param {?=} shouldBreakValuesets
     * @return {?}
     */
    moveOutValuesets(optionsToMove, pane, shouldBreakValuesets = false) {
        this.valueSetList.selectedOptions.forEach((/**
         * @param {?} v
         * @return {?}
         */
        v => {
            v.showValues = false;
            optionsToMove.valueSets.set(v.code, v);
            this.valueSetList.options.delete(v.code);
        }));
        this.valueSetList.filteredOptions.forEach((/**
         * @param {?} valueset
         * @return {?}
         */
        valueset => {
            if (valueset.selected || valueset.subValuesSelectList.selectedOptions.size < 1) {
                return;
            }
            if (shouldBreakValuesets) {
                this.breakValueset(valueset, optionsToMove, pane.companion);
            }
            else {
                this.moveSubValues(valueset.subValuesSelectList.selectedOptions, pane);
            }
        }));
    }
    /**
     * @private
     * @param {?} valueset
     * @param {?} optionsToMove
     * @param {?} companionPane
     * @return {?}
     */
    breakValueset(valueset, optionsToMove, companionPane) {
        valueset.showValues = false;
        optionsToMove.valueSets.set(valueset.code, valueset);
        this.valueSetList.options.delete(valueset.code);
        /** @type {?} */
        const unselectedSubValues = new Map();
        valueset.subValuesSelectList.filteredOptions
            .filter((/**
         * @param {?} o
         * @return {?}
         */
        o => !o.selected))
            .forEach((/**
         * @param {?} o
         * @return {?}
         */
        o => {
            unselectedSubValues.set(o.code, new ValueListOption(o.option, o.code));
        }));
        if (!companionPane) {
            return;
        }
        this.moveSubValues(unselectedSubValues, companionPane);
    }
    /**
     * @private
     * @param {?} valuesMap
     * @param {?} sourcePane
     * @return {?}
     */
    moveSubValues(valuesMap, sourcePane) {
        this.removeValuesFromPane(valuesMap, sourcePane);
        if (!sourcePane.companion) {
            return;
        }
        valuesMap.forEach((/**
         * @param {?} o
         * @return {?}
         */
        o => {
            // tslint:disable-next-line:no-non-null-assertion
            (/** @type {?} */ (sourcePane.companion)).valueList.options.set(o.code, new ValueListOption(o.option, o.code));
        }));
    }
    /**
     * Handles complex logic for when one pane is paged, and we want to keep the "x of y" counts accurate without a round trip to the server
     * @private
     * @param {?} valuesMap
     * @param {?} pane
     * @return {?}
     */
    removeValuesFromPane(valuesMap, pane) {
        if (pane.isPaged) {
            // don't bother trying to remove values or decrement count for options that are already filtered out
            this.filterService.preFilterOptionsForRemoteMode(valuesMap, pane.valueList);
        }
        valuesMap.forEach((/**
         * @param {?} v
         * @return {?}
         */
        v => {
            /** @type {?} */
            const optionDeleted = pane.valueList.options.delete(v.code);
            /** @type {?} */
            const optionAlreadyInCompanionList = pane.companion ? pane.companion.valueList.options.has(v.code) : false;
            if (!optionDeleted && pane.isPaged && !optionAlreadyInCompanionList) {
                pane.valueList.additionalRemoteOptions--;
            }
        }));
    }
}
PicklistValuesetMovingService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
PicklistValuesetMovingService.ctorParameters = () => [
    { type: PicklistFilterService },
    { type: PicklistStateService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    PicklistValuesetMovingService.prototype.filterService;
    /**
     * @type {?}
     * @private
     */
    PicklistValuesetMovingService.prototype.stateService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGlja2xpc3QtdmFsdWVzZXQtbW92aW5nLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaGVhbHRoY2F0YWx5c3QvY2FzaG1lcmUvIiwic291cmNlcyI6WyJsaWIvcGlja2xpc3Qvc2VydmljZXMvcGlja2xpc3QtdmFsdWVzZXQtbW92aW5nLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRXpDLE9BQU8sRUFBQyxxQkFBcUIsRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBRWhFLE9BQU8sRUFBNkMsZUFBZSxFQUFxQixNQUFNLDZCQUE2QixDQUFDO0FBQzVILE9BQU8sRUFBQyxvQkFBb0IsRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBRzlELE1BQU0sT0FBTyw2QkFBNkI7Ozs7O0lBUXRDLFlBQTJCLGFBQW9DLEVBQVUsWUFBa0M7UUFBaEYsa0JBQWEsR0FBYixhQUFhLENBQXVCO1FBQVUsaUJBQVksR0FBWixZQUFZLENBQXNCO0lBQUcsQ0FBQzs7OztJQVAvRyxJQUFXLFNBQVM7UUFDaEIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQztJQUN2QyxDQUFDOzs7O0lBQ0QsSUFBVyxZQUFZO1FBQ25CLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUM7SUFDMUMsQ0FBQzs7Ozs7OztJQUlNLGdCQUFnQixDQUFDLGFBQW1DLEVBQUUsSUFBMkIsRUFBRSx1QkFBZ0MsS0FBSztRQUMzSCxJQUFJLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxPQUFPOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDMUMsQ0FBQyxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7WUFDckIsYUFBYSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN2QyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8s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Q0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7WUFDMUcsSUFBSSxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsNEJBQTRCLEVBQUU7Z0JBQ2pFLElBQUksQ0FBQyxTQUFTLENBQUMsdUJBQXVCLEVBQUUsQ0FBQzthQUM1QztRQUNMLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7O1lBNUVKLFVBQVU7Ozs7WUFMSCxxQkFBcUI7WUFHckIsb0JBQW9COzs7Ozs7O0lBV0wsc0RBQTRDOzs7OztJQUFFLHFEQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7UGlja2xpc3RGaWx0ZXJTZXJ2aWNlfSBmcm9tICcuL3BpY2tsaXN0LWZpbHRlci5zZXJ2aWNlJztcbmltcG9ydCB7UGlja2xpc3RQYW5lQ29tcG9uZW50fSBmcm9tICcuLi9wYW5lL3BpY2tsaXN0LXBhbmUuY29tcG9uZW50JztcbmltcG9ydCB7RmlsdGVyYWJsZVNlbGVjdExpc3QsIFBpY2tsaXN0VmFsdWVPcHRpb25zLCBWYWx1ZUxpc3RPcHRpb24sIFZhbHVlU2V0TGlzdE9wdGlvbn0gZnJvbSAnLi4vcGFuZS9waWNrbGlzdC1wYW5lLm1vZGVsJztcbmltcG9ydCB7UGlja2xpc3RTdGF0ZVNlcnZpY2V9IGZyb20gJy4vcGlja2xpc3Qtc3RhdGUuc2VydmljZSc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBQaWNrbGlzdFZhbHVlc2V0TW92aW5nU2VydmljZSB7XG4gICAgcHVibGljIGdldCB2YWx1ZUxpc3QoKTogRmlsdGVyYWJsZVNlbGVjdExpc3Q8VmFsdWVMaXN0T3B0aW9uPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlU2VydmljZS52YWx1ZUxpc3Q7XG4gICAgfVxuICAgIHB1YmxpYyBnZXQgdmFsdWVTZXRMaXN0KCk6IEZpbHRlcmFibGVTZWxlY3RMaXN0PFZhbHVlU2V0TGlzdE9wdGlvbj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZVNlcnZpY2UudmFsdWVTZXRMaXN0O1xuICAgIH1cblxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIGZpbHRlclNlcnZpY2U6IFBpY2tsaXN0RmlsdGVyU2VydmljZSwgcHJpdmF0ZSBzdGF0ZVNlcnZpY2U6IFBpY2tsaXN0U3RhdGVTZXJ2aWNlKSB7fVxuXG4gICAgcHVibGljIG1vdmVPdXRWYWx1ZXNldHMob3B0aW9uc1RvTW92ZTogUGlja2xpc3RWYWx1ZU9wdGlvbnMsIHBhbmU6IFBpY2tsaXN0UGFuZUNvbXBvbmVudCwgc2hvdWxkQnJlYWtWYWx1ZXNldHM6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICB0aGlzLnZhbHVlU2V0TGlzdC5zZWxlY3RlZE9wdGlvbnMuZm9yRWFjaCh2ID0+IHtcbiAgICAgICAgICAgIHYuc2hvd1ZhbHVlcyA9IGZhbHNlO1xuICAgICAgICAgICAgb3B0aW9uc1RvTW92ZS52YWx1ZVNldHMuc2V0KHYuY29kZSwgdik7XG4gICAgICAgICAgICB0aGlzLnZhbHVlU2V0TGlzdC5vcHRpb25zLmRlbGV0ZSh2LmNvZGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnZhbHVlU2V0TGlzdC5maWx0ZXJlZE9wdGlvbnMuZm9yRWFjaCh2YWx1ZXNldCA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWVzZXQuc2VsZWN0ZWQgfHwgdmFsdWVzZXQuc3ViVmFsdWVzU2VsZWN0TGlzdC5zZWxlY3RlZE9wdGlvbnMuc2l6ZSA8IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzaG91bGRCcmVha1ZhbHVlc2V0cykge1xuICAgICAgICAgICAgICAgIHRoaXMuYnJlYWtWYWx1ZXNldCh2YWx1ZXNldCwgb3B0aW9uc1RvTW92ZSwgcGFuZS5jb21wYW5pb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTdWJWYWx1ZXModmFsdWVzZXQuc3ViVmFsdWVzU2VsZWN0TGlzdC5zZWxlY3RlZE9wdGlvbnMsIHBhbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJyZWFrVmFsdWVzZXQodmFsdWVzZXQ6IFZhbHVlU2V0TGlzdE9wdGlvbiwgb3B0aW9uc1RvTW92ZTogUGlja2xpc3RWYWx1ZU9wdGlvbnMsIGNvbXBhbmlvblBhbmU6IFBpY2tsaXN0UGFuZUNvbXBvbmVudCB8IG51bGwpIHtcbiAgICAgICAgdmFsdWVzZXQuc2hvd1ZhbHVlcyA9IGZhbHNlO1xuICAgICAgICBvcHRpb25zVG9Nb3ZlLnZhbHVlU2V0cy5zZXQodmFsdWVzZXQuY29kZSwgdmFsdWVzZXQpO1xuICAgICAgICB0aGlzLnZhbHVlU2V0TGlzdC5vcHRpb25zLmRlbGV0ZSh2YWx1ZXNldC5jb2RlKTtcblxuICAgICAgICBjb25zdCB1bnNlbGVjdGVkU3ViVmFsdWVzID0gbmV3IE1hcDxzdHJpbmcsIFZhbHVlTGlzdE9wdGlvbj4oKTtcbiAgICAgICAgdmFsdWVzZXQuc3ViVmFsdWVzU2VsZWN0TGlzdC5maWx0ZXJlZE9wdGlvbnNcbiAgICAgICAgICAgIC5maWx0ZXIobyA9PiAhby5zZWxlY3RlZClcbiAgICAgICAgICAgIC5mb3JFYWNoKG8gPT4ge1xuICAgICAgICAgICAgICAgIHVuc2VsZWN0ZWRTdWJWYWx1ZXMuc2V0KG8uY29kZSwgbmV3IFZhbHVlTGlzdE9wdGlvbihvLm9wdGlvbiwgby5jb2RlKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWNvbXBhbmlvblBhbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vdmVTdWJWYWx1ZXModW5zZWxlY3RlZFN1YlZhbHVlcywgY29tcGFuaW9uUGFuZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBtb3ZlU3ViVmFsdWVzKHZhbHVlc01hcDogTWFwPHN0cmluZywgVmFsdWVMaXN0T3B0aW9uPiwgc291cmNlUGFuZTogUGlja2xpc3RQYW5lQ29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlVmFsdWVzRnJvbVBhbmUodmFsdWVzTWFwLCBzb3VyY2VQYW5lKTtcbiAgICAgICAgaWYgKCFzb3VyY2VQYW5lLmNvbXBhbmlvbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlc01hcC5mb3JFYWNoKG8gPT4ge1xuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgc291cmNlUGFuZS5jb21wYW5pb24hLnZhbHVlTGlzdC5vcHRpb25zLnNldChvLmNvZGUsIG5ldyBWYWx1ZUxpc3RPcHRpb24oby5vcHRpb24sIG8uY29kZSkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGNvbXBsZXggbG9naWMgZm9yIHdoZW4gb25lIHBhbmUgaXMgcGFnZWQsIGFuZCB3ZSB3YW50IHRvIGtlZXAgdGhlIFwieCBvZiB5XCIgY291bnRzIGFjY3VyYXRlIHdpdGhvdXQgYSByb3VuZCB0cmlwIHRvIHRoZSBzZXJ2ZXJcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbW92ZVZhbHVlc0Zyb21QYW5lKHZhbHVlc01hcDogTWFwPHN0cmluZywgVmFsdWVMaXN0T3B0aW9uPiwgcGFuZTogUGlja2xpc3RQYW5lQ29tcG9uZW50KSB7XG4gICAgICAgIGlmIChwYW5lLmlzUGFnZWQpIHtcbiAgICAgICAgICAgIC8vIGRvbid0IGJvdGhlciB0cnlpbmcgdG8gcmVtb3ZlIHZhbHVlcyBvciBkZWNyZW1lbnQgY291bnQgZm9yIG9wdGlvbnMgdGhhdCBhcmUgYWxyZWFkeSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyU2VydmljZS5wcmVGaWx0ZXJPcHRpb25zRm9yUmVtb3RlTW9kZSh2YWx1ZXNNYXAsIHBhbmUudmFsdWVMaXN0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhbHVlc01hcC5mb3JFYWNoKHYgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uRGVsZXRlZCA9IHBhbmUudmFsdWVMaXN0Lm9wdGlvbnMuZGVsZXRlKHYuY29kZSk7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25BbHJlYWR5SW5Db21wYW5pb25MaXN0ID0gcGFuZS5jb21wYW5pb24gPyBwYW5lLmNvbXBhbmlvbi52YWx1ZUxpc3Qub3B0aW9ucy5oYXModi5jb2RlKSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFvcHRpb25EZWxldGVkICYmIHBhbmUuaXNQYWdlZCAmJiAhb3B0aW9uQWxyZWFkeUluQ29tcGFuaW9uTGlzdCkge1xuICAgICAgICAgICAgICAgIHBhbmUudmFsdWVMaXN0LmFkZGl0aW9uYWxSZW1vdGVPcHRpb25zLS07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==