/**
 * @fileoverview added by tsickle
 * Generated from: lib/select/select.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, forwardRef, HostBinding, Input, ViewEncapsulation, ElementRef, Optional, Self, Output, EventEmitter, ContentChildren, QueryList, ViewChild } from '@angular/core';
import { NgForm, FormGroupDirective, NgControl } from '@angular/forms';
import { HcFormControlComponent } from '../form-field/hc-form-control.component';
import { parseBooleanAttribute } from '../util';
import { HcOptionDirective } from './hc-option.directive';
/** @type {?} */
let uniqueId = 1;
export class SelectChangeEvent {
    /**
     * @param {?} source
     * @param {?} value
     */
    constructor(source, value) {
        this.source = source;
        this.value = value;
    }
}
if (false) {
    /** @type {?} */
    SelectChangeEvent.prototype.source;
    /** @type {?} */
    SelectChangeEvent.prototype.value;
}
/**
 * Select one of many options from a dropdown
 */
export class SelectComponent extends HcFormControlComponent {
    /**
     * @param {?} _parentForm
     * @param {?} _parentFormGroup
     * @param {?} _ngControl
     */
    constructor(_parentForm, _parentFormGroup, _ngControl) {
        super();
        this._ngControl = _ngControl;
        this._uniqueInputId = `hc-select-${uniqueId++}`;
        this._tight = false;
        this._value = '';
        this._componentId = this._uniqueInputId;
        this.focus = new EventEmitter();
        this.blur = new EventEmitter();
        /**
         * Event emitted whenever the state changes
         */
        this.change = new EventEmitter();
        this._hostClass = true;
        this.onChange = (/**
         * @return {?}
         */
        () => { });
        this.onTouched = (/**
         * @return {?}
         */
        () => { });
        this._form = _parentForm || _parentFormGroup;
        if (this._ngControl != null) {
            this._ngControl.valueAccessor = this;
        }
    }
    /**
     * Enables or disables the component
     * @return {?}
     */
    get disabled() {
        if (this._ngControl && this._ngControl.disabled) {
            return this._ngControl.disabled;
        }
        return this._isDisabled;
    }
    /**
     * @param {?} disabledVal
     * @return {?}
     */
    set disabled(disabledVal) {
        this._isDisabled = parseBooleanAttribute(disabledVal);
    }
    /**
     * Sets whether this is a required form element
     * @return {?}
     */
    get required() {
        return this._isRequired;
    }
    /**
     * @param {?} requiredVal
     * @return {?}
     */
    set required(requiredVal) {
        this._isRequired = parseBooleanAttribute(requiredVal);
    }
    /**
     * Element id.
     * @return {?}
     */
    get id() {
        return this._componentId || this._uniqueInputId;
    }
    /**
     * @param {?} idVal
     * @return {?}
     */
    set id(idVal) {
        this._componentId = idVal ? idVal : this._uniqueInputId;
    }
    /**
     * Get or set the value of the select component
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set value(val) {
        if (val !== this._value) {
            this._value = val;
            this.onChange(val);
        }
    }
    /**
     * If true, condense the default margin and reduce the font size. *Defaults to `false`.*
     * @return {?}
     */
    get tight() {
        return this._tight;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set tight(value) {
        this._tight = parseBooleanAttribute(value);
    }
    /**
     * @return {?}
     */
    get _disabledClass() {
        if (this._ngControl && this._ngControl.disabled) {
            return this._ngControl.disabled;
        }
        return this._isDisabled;
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        if (this._valueData) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.writeValue(this._valueData);
            }));
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        this._valueData = value;
        /** @type {?} */
        let targetVal = value;
        // If ngValue is being used, set the currently selected value based on that data
        if (this._options && this._options.length !== 0) {
            /** @type {?} */
            let selectedIndex = 0;
            this._options.forEach((/**
             * @param {?} option
             * @param {?} index
             * @return {?}
             */
            (option, index) => {
                if (option.ngValue === value) {
                    selectedIndex = index;
                }
            }));
            if (this.placeholder) {
                selectedIndex += 1;
            }
            targetVal = this._nativeSelect.nativeElement.options[selectedIndex].value;
        }
        this._value = targetVal;
    }
    /**
     * @param {?} event
     * @param {?} value
     * @return {?}
     */
    _change(event, value) {
        this._valueData = value;
        // If ngValue is being used, pull that value from the directive to allow objects well as strings
        if (this._options.length !== 0) {
            /** @type {?} */
            const optionArray = this._options.toArray();
            /** @type {?} */
            const index = this.placeholder
                ? this._nativeSelect.nativeElement.selectedIndex - 1
                : this._nativeSelect.nativeElement.selectedIndex;
            this._valueData = optionArray[index].ngValue;
        }
        event.stopPropagation();
        this._value = value;
        this.onChange(this._valueData);
        this.change.emit(new SelectChangeEvent(this, this._valueData));
    }
    /**
     * @return {?}
     */
    ngDoCheck() {
        // This needs to be checked every cycle because we can't subscribe to form submissions
        if (this._ngControl) {
            this._updateErrorState();
        }
    }
    /**
     * @private
     * @return {?}
     */
    _updateErrorState() {
        /** @type {?} */
        const oldState = this._errorState;
        // TODO: this could be abstracted out as an @Input() if we need this to be configurable
        /** @type {?} */
        const newState = !!(this._ngControl &&
            this._ngControl.invalid &&
            (this._ngControl.touched || (this._form && this._form.submitted)));
        if (oldState !== newState) {
            this._errorState = newState;
        }
    }
}
SelectComponent.decorators = [
    { type: Component, args: [{
                selector: 'hc-select',
                template: "<div class=\"hc-select-container\" [class.hc-select-tight]=\"tight\">\n    <span class=\"hc-select-chevron\"></span>\n    <select\n        #selectInput\n        class=\"hc-select-input\"\n        [disabled]=\"disabled\"\n        (change)=\"_change($event, selectInput.value)\"\n        [value]=\"value\"\n        (focus)=\"focus.next()\"\n        (blur)=\"blur.next()\"\n        [required]=\"required\"\n    >\n        <option *ngIf=\"placeholder\" value=\"\" selected disabled hidden>{{ placeholder }}</option>\n        <ng-content></ng-content>\n    </select>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                providers: [{ provide: HcFormControlComponent, useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => SelectComponent)) }],
                styles: [".hc-select{display:inline-block;width:100%}.hc-select-container{position:relative}.hc-select-container select:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}@-moz-document url-prefix(){.hc-select-container select:focus{outline:#6d6e70 dotted 1px;outline-offset:-3px}}.hc-select-chevron{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;height:35px;-webkit-box-pack:center;justify-content:center;line-height:35px;pointer-events:none;position:absolute;right:0;text-align:center;top:0;width:35px}.hc-select-chevron:after{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNi45NzgiIGhlaWdodD0iMTcuMzE5IiB2aWV3Qm94PSIwIDAgMjYuOTc4IDE3LjMxOSI+CiAgPGRlZnM+CiAgICA8c3R5bGU+CiAgICAgIC5jbHMtMSB7CiAgICAgICAgZmlsbDogIzAwYWVmZjsKICAgICAgfQogICAgPC9zdHlsZT4KICA8L2RlZnM+CiAgPHBhdGggaWQ9IlBhdGhfNSIgZGF0YS1uYW1lPSJQYXRoIDUiIGNsYXNzPSJjbHMtMSIgZD0iTTI4LjE3NS0xMi4xODhhMS4wODEsMS4wODEsMCwwLDAsMC0xLjUyM0wyNS40LTE2LjQ3M2ExLjA2MSwxLjA2MSwwLDAsMC0xLjUwNywwTDE1LTcuNTg0bC04Ljg5LTguODlhMS4wNjEsMS4wNjEsMCwwLDAtMS41MDcsMEwxLjgyNS0xMy43MTFhMS4wODEsMS4wODEsMCwwLDAsMCwxLjUyM0wxNC4yNDcuMjE4YTEuMDYxLDEuMDYxLDAsMCwwLDEuNTA3LDBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMS41MTEgMTYuNzg3KSIvPgo8L3N2Zz4K);background-repeat:no-repeat;background-size:contain;box-sizing:border-box;content:'';height:8.5px;margin-top:2px;pointer-events:none;width:13px}.hc-select-disabled .hc-select-chevron{opacity:.4}.hc-select-tight .hc-select-chevron{height:28px}.hc-select-input{font-size:1rem;-webkit-appearance:none;-moz-appearance:none;background-color:#fff;border:1px solid #ccc;box-shadow:inset .5px .5px 0 #ccc,inset -.5px -.5px 0 #ccc;border-radius:0;color:#333;cursor:pointer;font:inherit;height:35px;line-height:1.3;padding-left:9px;padding-right:32px;width:100%}.hc-select-input::-ms-expand{display:none}.hc-select-input[disabled]{background-color:#f0f3f6;border:1px solid #e0e0e0;box-shadow:inset .5px .5px 0 #e0e0e0,inset -.5px -.5px 0 #e0e0e0;color:#adadad;cursor:not-allowed}.hc-form-field-invalid .hc-select-input{border:1px solid #cc2027;box-shadow:inset .5px .5px 0 #cc2027,inset -.5px -.5px 0 #cc2027}.hc-select-tight .hc-select-input{font-size:.92857rem;height:28px}@media all and (-ms-high-contrast:none){.hc-select-input,.hc-select-input-invalid,.hc-select-input[disabled]{border-width:2px;box-shadow:none}}"]
            }] }
];
/** @nocollapse */
SelectComponent.ctorParameters = () => [
    { type: NgForm, decorators: [{ type: Optional }] },
    { type: FormGroupDirective, decorators: [{ type: Optional }] },
    { type: NgControl, decorators: [{ type: Optional }, { type: Self }] }
];
SelectComponent.propDecorators = {
    _options: [{ type: ContentChildren, args: [HcOptionDirective,] }],
    _nativeSelect: [{ type: ViewChild, args: ['selectInput', { static: false },] }],
    placeholder: [{ type: Input }],
    disabled: [{ type: Input }],
    required: [{ type: Input }],
    id: [{ type: Input }],
    value: [{ type: Input }],
    tight: [{ type: Input }],
    focus: [{ type: Output }],
    blur: [{ type: Output }],
    change: [{ type: Output }],
    _hostClass: [{ type: HostBinding, args: ['class.hc-select',] }],
    _disabledClass: [{ type: HostBinding, args: ['class.hc-select-disabled',] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._uniqueInputId;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._form;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._tight;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._value;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype._valueData;
    /** @type {?} */
    SelectComponent.prototype._componentId;
    /** @type {?} */
    SelectComponent.prototype._options;
    /** @type {?} */
    SelectComponent.prototype._nativeSelect;
    /**
     * Optional string of text to appear before selection is made
     * @type {?}
     */
    SelectComponent.prototype.placeholder;
    /** @type {?} */
    SelectComponent.prototype.focus;
    /** @type {?} */
    SelectComponent.prototype.blur;
    /**
     * Event emitted whenever the state changes
     * @type {?}
     */
    SelectComponent.prototype.change;
    /** @type {?} */
    SelectComponent.prototype._hostClass;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype.onChange;
    /**
     * @type {?}
     * @private
     */
    SelectComponent.prototype.onTouched;
    /** @type {?} */
    SelectComponent.prototype._ngControl;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BoZWFsdGhjYXRhbHlzdC9jYXNobWVyZS8iLCJzb3VyY2VzIjpbImxpYi9zZWxlY3Qvc2VsZWN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFdBQVcsRUFDWCxLQUFLLEVBQ0wsaUJBQWlCLEVBQ2pCLFVBQVUsRUFDVixRQUFRLEVBRVIsSUFBSSxFQUNKLE1BQU0sRUFDTixZQUFZLEVBQ1osZUFBZSxFQUNmLFNBQVMsRUFDVCxTQUFTLEVBRVosTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF1QixNQUFNLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0YsT0FBTyxFQUFDLHNCQUFzQixFQUFDLE1BQU0seUNBQXlDLENBQUM7QUFDL0UsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQzlDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHVCQUF1QixDQUFDOztJQUVwRCxRQUFRLEdBQUcsQ0FBQztBQUVoQixNQUFNLE9BQU8saUJBQWlCOzs7OztJQUMxQixZQUFtQixNQUF1QixFQUFTLEtBQVU7UUFBMUMsV0FBTSxHQUFOLE1BQU0sQ0FBaUI7UUFBUyxVQUFLLEdBQUwsS0FBSyxDQUFLO0lBQUcsQ0FBQztDQUNwRTs7O0lBRGUsbUNBQThCOztJQUFFLGtDQUFpQjs7Ozs7QUFXakUsTUFBTSxPQUFPLGVBQWdCLFNBQVEsc0JBQXNCOzs7Ozs7SUE4RnZELFlBQ2dCLFdBQW1CLEVBQ25CLGdCQUFvQyxFQUd6QyxVQUFxQjtRQUU1QixLQUFLLEVBQUUsQ0FBQztRQUZELGVBQVUsR0FBVixVQUFVLENBQVc7UUFsR3hCLG1CQUFjLEdBQUcsYUFBYSxRQUFRLEVBQUUsRUFBRSxDQUFDO1FBRTNDLFdBQU0sR0FBWSxLQUFLLENBQUM7UUFDeEIsV0FBTSxHQUFRLEVBQUUsQ0FBQztRQUd6QixpQkFBWSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUM7UUFvRTFCLFVBQUssR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQztRQUVyRCxTQUFJLEdBQXVCLElBQUksWUFBWSxFQUFRLENBQUM7Ozs7UUFJN0QsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFxQixDQUFDO1FBRy9DLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFpQ1YsYUFBUTs7O1FBQXVCLEdBQUcsRUFBRSxHQUFFLENBQUMsRUFBQztRQUV4QyxjQUFTOzs7UUFBdUIsR0FBRyxFQUFFLEdBQUUsQ0FBQyxFQUFDO1FBaEI3QyxJQUFJLENBQUMsS0FBSyxHQUFHLFdBQVcsSUFBSSxnQkFBZ0IsQ0FBQztRQUM3QyxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxFQUFFO1lBQ3pCLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztTQUN4QztJQUNMLENBQUM7Ozs7O0lBdkZELElBQ0ksUUFBUTtRQUNSLElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRTtZQUM3QyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDO1NBQ25DO1FBQ0QsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7Ozs7O0lBRUQsSUFBSSxRQUFRLENBQUMsV0FBVztRQUNwQixJQUFJLENBQUMsV0FBVyxHQUFHLHFCQUFxQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzFELENBQUM7Ozs7O0lBR0QsSUFDSSxRQUFRO1FBQ1IsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7Ozs7O0lBRUQsSUFBSSxRQUFRLENBQUMsV0FBVztRQUNwQixJQUFJLENBQUMsV0FBVyxHQUFHLHFCQUFxQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzFELENBQUM7Ozs7O0lBR0QsSUFDSSxFQUFFO1FBQ0YsT0FBTyxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDcEQsQ0FBQzs7Ozs7SUFFRCxJQUFJLEVBQUUsQ0FBQyxLQUFhO1FBQ2hCLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDNUQsQ0FBQzs7Ozs7SUFHRCxJQUNJLEtBQUs7UUFDTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDdkIsQ0FBQzs7Ozs7SUFFRCxJQUFJLEtBQUssQ0FBQyxHQUFRO1FBQ2QsSUFBSSxHQUFHLEtBQUssSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztZQUNsQixJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3RCO0lBQ0wsQ0FBQzs7Ozs7SUFHRCxJQUNJLEtBQUs7UUFDTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDdkIsQ0FBQzs7Ozs7SUFDRCxJQUFJLEtBQUssQ0FBQyxLQUFLO1FBQ1gsSUFBSSxDQUFDLE1BQU0sR0FBRyxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMvQyxDQUFDOzs7O0lBY0QsSUFDSSxjQUFjO1FBQ2QsSUFBSSxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFO1lBQzdDLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUM7U0FDbkM7UUFDRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDNUIsQ0FBQzs7OztJQWlCRCxrQkFBa0I7UUFDZCxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDakIsVUFBVTs7O1lBQUMsR0FBRyxFQUFFO2dCQUNaLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3JDLENBQUMsRUFBQyxDQUFDO1NBQ047SUFDTCxDQUFDOzs7OztJQU1ELGdCQUFnQixDQUFDLEVBQU87UUFDcEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7Ozs7SUFFRCxpQkFBaUIsQ0FBQyxFQUFPO1FBQ3JCLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQ3hCLENBQUM7Ozs7O0lBRUQsVUFBVSxDQUFDLEtBQVU7UUFDakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7O1lBQ3BCLFNBQVMsR0FBRyxLQUFLO1FBQ3JCLGdGQUFnRjtRQUNoRixJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFOztnQkFDekMsYUFBYSxHQUFXLENBQUM7WUFDN0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPOzs7OztZQUFDLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFO2dCQUNwQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLEtBQUssS0FBSyxFQUFFO29CQUMxQixhQUFhLEdBQUcsS0FBSyxDQUFDO2lCQUN6QjtZQUNMLENBQUMsRUFBQyxDQUFDO1lBQ0gsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUNsQixhQUFhLElBQUksQ0FBQyxDQUFDO2FBQ3RCO1lBQ0QsU0FBUyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxLQUFLLENBQUM7U0FDN0U7UUFDRCxJQUFJLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQztJQUM1QixDQUFDOzs7Ozs7SUFFRCxPQUFPLENBQUMsS0FBWSxFQUFFLEtBQVU7UUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDeEIsZ0dBQWdHO1FBQ2hHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFOztrQkFDdEIsV0FBVyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFOztrQkFDckMsS0FBSyxHQUFHLElBQUksQ0FBQyxXQUFXO2dCQUMxQixDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsYUFBYSxHQUFHLENBQUM7Z0JBQ3BELENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxhQUFhO1lBQ3BELElBQUksQ0FBQyxVQUFVLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQztTQUNoRDtRQUVELEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMvQixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLGlCQUFpQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUNuRSxDQUFDOzs7O0lBRUQsU0FBUztRQUNMLHNGQUFzRjtRQUN0RixJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDakIsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7U0FDNUI7SUFDTCxDQUFDOzs7OztJQUVPLGlCQUFpQjs7Y0FDZixRQUFRLEdBQUcsSUFBSSxDQUFDLFdBQVc7OztjQUczQixRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQ2YsSUFBSSxDQUFDLFVBQVU7WUFDZixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU87WUFDdkIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUNwRTtRQUVELElBQUksUUFBUSxLQUFLLFFBQVEsRUFBRTtZQUN2QixJQUFJLENBQUMsV0FBVyxHQUFHLFFBQVEsQ0FBQztTQUMvQjtJQUNMLENBQUM7OztZQWhNSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLFdBQVc7Z0JBQ3JCLHVrQkFBb0M7Z0JBRXBDLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO2dCQUNyQyxTQUFTLEVBQUUsQ0FBQyxFQUFDLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxXQUFXLEVBQUUsVUFBVTs7O3dCQUFDLEdBQUcsRUFBRSxDQUFDLGVBQWUsRUFBQyxFQUFDLENBQUM7O2FBQ2pHOzs7O1lBbEI2QixNQUFNLHVCQWtIM0IsUUFBUTtZQWxIcUIsa0JBQWtCLHVCQW1IL0MsUUFBUTtZQW5IeUMsU0FBUyx1QkFvSDFELFFBQVEsWUFDUixJQUFJOzs7dUJBekZSLGVBQWUsU0FBQyxpQkFBaUI7NEJBR2pDLFNBQVMsU0FBQyxhQUFhLEVBQUUsRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFDOzBCQUl4QyxLQUFLO3VCQUlMLEtBQUs7dUJBYUwsS0FBSztpQkFVTCxLQUFLO29CQVVMLEtBQUs7b0JBYUwsS0FBSztvQkFRTCxNQUFNO21CQUVOLE1BQU07cUJBSU4sTUFBTTt5QkFHTixXQUFXLFNBQUMsaUJBQWlCOzZCQUc3QixXQUFXLFNBQUMsMEJBQTBCOzs7Ozs7O0lBckZ2Qyx5Q0FBbUQ7Ozs7O0lBQ25ELGdDQUFrRDs7Ozs7SUFDbEQsaUNBQWdDOzs7OztJQUNoQyxpQ0FBeUI7Ozs7O0lBQ3pCLHFDQUF3Qjs7SUFFeEIsdUNBQW1DOztJQUVuQyxtQ0FDdUM7O0lBRXZDLHdDQUMwQjs7Ozs7SUFHMUIsc0NBQ29COztJQXlEcEIsZ0NBQzhEOztJQUM5RCwrQkFDNkQ7Ozs7O0lBRzdELGlDQUMrQzs7SUFFL0MscUNBQ2tCOzs7OztJQWlDbEIsbUNBQWdEOzs7OztJQUVoRCxvQ0FBaUQ7O0lBdEI3QyxxQ0FFNEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBmb3J3YXJkUmVmLFxuICAgIEhvc3RCaW5kaW5nLFxuICAgIElucHV0LFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxuICAgIEVsZW1lbnRSZWYsXG4gICAgT3B0aW9uYWwsXG4gICAgRG9DaGVjayxcbiAgICBTZWxmLFxuICAgIE91dHB1dCxcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgQ29udGVudENoaWxkcmVuLFxuICAgIFF1ZXJ5TGlzdCxcbiAgICBWaWV3Q2hpbGQsXG4gICAgQWZ0ZXJDb250ZW50SW5pdFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29udHJvbFZhbHVlQWNjZXNzb3IsIE5nRm9ybSwgRm9ybUdyb3VwRGlyZWN0aXZlLCBOZ0NvbnRyb2x9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7SGNGb3JtQ29udHJvbENvbXBvbmVudH0gZnJvbSAnLi4vZm9ybS1maWVsZC9oYy1mb3JtLWNvbnRyb2wuY29tcG9uZW50JztcbmltcG9ydCB7cGFyc2VCb29sZWFuQXR0cmlidXRlfSBmcm9tICcuLi91dGlsJztcbmltcG9ydCB7SGNPcHRpb25EaXJlY3RpdmV9IGZyb20gJy4vaGMtb3B0aW9uLmRpcmVjdGl2ZSc7XG5cbmxldCB1bmlxdWVJZCA9IDE7XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3RDaGFuZ2VFdmVudCB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHNvdXJjZTogU2VsZWN0Q29tcG9uZW50LCBwdWJsaWMgdmFsdWU6IGFueSkge31cbn1cblxuLyoqIFNlbGVjdCBvbmUgb2YgbWFueSBvcHRpb25zIGZyb20gYSBkcm9wZG93biAqL1xuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdoYy1zZWxlY3QnLFxuICAgIHRlbXBsYXRlVXJsOiAnc2VsZWN0LmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnc2VsZWN0LmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgICBwcm92aWRlcnM6IFt7cHJvdmlkZTogSGNGb3JtQ29udHJvbENvbXBvbmVudCwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gU2VsZWN0Q29tcG9uZW50KX1dXG59KVxuZXhwb3J0IGNsYXNzIFNlbGVjdENvbXBvbmVudCBleHRlbmRzIEhjRm9ybUNvbnRyb2xDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgQWZ0ZXJDb250ZW50SW5pdCwgRG9DaGVjayB7XG4gICAgcHJpdmF0ZSBfdW5pcXVlSW5wdXRJZCA9IGBoYy1zZWxlY3QtJHt1bmlxdWVJZCsrfWA7XG4gICAgcHJpdmF0ZSBfZm9ybTogTmdGb3JtIHwgRm9ybUdyb3VwRGlyZWN0aXZlIHwgbnVsbDtcbiAgICBwcml2YXRlIF90aWdodDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgX3ZhbHVlOiBhbnkgPSAnJztcbiAgICBwcml2YXRlIF92YWx1ZURhdGE6IGFueTtcblxuICAgIF9jb21wb25lbnRJZCA9IHRoaXMuX3VuaXF1ZUlucHV0SWQ7XG5cbiAgICBAQ29udGVudENoaWxkcmVuKEhjT3B0aW9uRGlyZWN0aXZlKVxuICAgIF9vcHRpb25zOiBRdWVyeUxpc3Q8SGNPcHRpb25EaXJlY3RpdmU+O1xuXG4gICAgQFZpZXdDaGlsZCgnc2VsZWN0SW5wdXQnLCB7c3RhdGljOiBmYWxzZX0pXG4gICAgX25hdGl2ZVNlbGVjdDogRWxlbWVudFJlZjtcblxuICAgIC8qKiBPcHRpb25hbCBzdHJpbmcgb2YgdGV4dCB0byBhcHBlYXIgYmVmb3JlIHNlbGVjdGlvbiBpcyBtYWRlICovXG4gICAgQElucHV0KClcbiAgICBwbGFjZWhvbGRlcjogc3RyaW5nO1xuXG4gICAgLyoqIEVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGNvbXBvbmVudCAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5fbmdDb250cm9sICYmIHRoaXMuX25nQ29udHJvbC5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25nQ29udHJvbC5kaXNhYmxlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXNEaXNhYmxlZDtcbiAgICB9XG5cbiAgICBzZXQgZGlzYWJsZWQoZGlzYWJsZWRWYWwpIHtcbiAgICAgICAgdGhpcy5faXNEaXNhYmxlZCA9IHBhcnNlQm9vbGVhbkF0dHJpYnV0ZShkaXNhYmxlZFZhbCk7XG4gICAgfVxuXG4gICAgLyoqIFNldHMgd2hldGhlciB0aGlzIGlzIGEgcmVxdWlyZWQgZm9ybSBlbGVtZW50ICovXG4gICAgQElucHV0KClcbiAgICBnZXQgcmVxdWlyZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1JlcXVpcmVkO1xuICAgIH1cblxuICAgIHNldCByZXF1aXJlZChyZXF1aXJlZFZhbCkge1xuICAgICAgICB0aGlzLl9pc1JlcXVpcmVkID0gcGFyc2VCb29sZWFuQXR0cmlidXRlKHJlcXVpcmVkVmFsKTtcbiAgICB9XG5cbiAgICAvKiogRWxlbWVudCBpZC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBpZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50SWQgfHwgdGhpcy5fdW5pcXVlSW5wdXRJZDtcbiAgICB9XG5cbiAgICBzZXQgaWQoaWRWYWw6IHN0cmluZykge1xuICAgICAgICB0aGlzLl9jb21wb25lbnRJZCA9IGlkVmFsID8gaWRWYWwgOiB0aGlzLl91bmlxdWVJbnB1dElkO1xuICAgIH1cblxuICAgIC8qKiBHZXQgb3Igc2V0IHRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0IGNvbXBvbmVudCAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxuXG4gICAgc2V0IHZhbHVlKHZhbDogYW55KSB7XG4gICAgICAgIGlmICh2YWwgIT09IHRoaXMuX3ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbDtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2UodmFsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBJZiB0cnVlLCBjb25kZW5zZSB0aGUgZGVmYXVsdCBtYXJnaW4gYW5kIHJlZHVjZSB0aGUgZm9udCBzaXplLiAqRGVmYXVsdHMgdG8gYGZhbHNlYC4qICAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IHRpZ2h0KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGlnaHQ7XG4gICAgfVxuICAgIHNldCB0aWdodCh2YWx1ZSkge1xuICAgICAgICB0aGlzLl90aWdodCA9IHBhcnNlQm9vbGVhbkF0dHJpYnV0ZSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgZm9jdXM6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgICBAT3V0cHV0KClcbiAgICByZWFkb25seSBibHVyOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgICAvKiogRXZlbnQgZW1pdHRlZCB3aGVuZXZlciB0aGUgc3RhdGUgY2hhbmdlcyAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8U2VsZWN0Q2hhbmdlRXZlbnQ+KCk7XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmhjLXNlbGVjdCcpXG4gICAgX2hvc3RDbGFzcyA9IHRydWU7XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmhjLXNlbGVjdC1kaXNhYmxlZCcpXG4gICAgZ2V0IF9kaXNhYmxlZENsYXNzKCkge1xuICAgICAgICBpZiAodGhpcy5fbmdDb250cm9sICYmIHRoaXMuX25nQ29udHJvbC5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25nQ29udHJvbC5kaXNhYmxlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXNEaXNhYmxlZDtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgQE9wdGlvbmFsKCkgX3BhcmVudEZvcm06IE5nRm9ybSxcbiAgICAgICAgQE9wdGlvbmFsKCkgX3BhcmVudEZvcm1Hcm91cDogRm9ybUdyb3VwRGlyZWN0aXZlLFxuICAgICAgICBAT3B0aW9uYWwoKVxuICAgICAgICBAU2VsZigpXG4gICAgICAgIHB1YmxpYyBfbmdDb250cm9sOiBOZ0NvbnRyb2xcbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLl9mb3JtID0gX3BhcmVudEZvcm0gfHwgX3BhcmVudEZvcm1Hcm91cDtcbiAgICAgICAgaWYgKHRoaXMuX25nQ29udHJvbCAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9uZ0NvbnRyb2wudmFsdWVBY2Nlc3NvciA9IHRoaXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLl92YWx1ZURhdGEpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMud3JpdGVWYWx1ZSh0aGlzLl92YWx1ZURhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ2hhbmdlOiAodmFsOiBhbnkpID0+IHZvaWQgPSAoKSA9PiB7fTtcblxuICAgIHByaXZhdGUgb25Ub3VjaGVkOiAodmFsOiBhbnkpID0+IHZvaWQgPSAoKSA9PiB7fTtcblxuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSkge1xuICAgICAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gICAgfVxuXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSkge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICAgIH1cblxuICAgIHdyaXRlVmFsdWUodmFsdWU6IGFueSkge1xuICAgICAgICB0aGlzLl92YWx1ZURhdGEgPSB2YWx1ZTtcbiAgICAgICAgbGV0IHRhcmdldFZhbCA9IHZhbHVlO1xuICAgICAgICAvLyBJZiBuZ1ZhbHVlIGlzIGJlaW5nIHVzZWQsIHNldCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHZhbHVlIGJhc2VkIG9uIHRoYXQgZGF0YVxuICAgICAgICBpZiAodGhpcy5fb3B0aW9ucyAmJiB0aGlzLl9vcHRpb25zLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgbGV0IHNlbGVjdGVkSW5kZXg6IG51bWJlciA9IDA7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zLmZvckVhY2goKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uLm5nVmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0VmFsID0gdGhpcy5fbmF0aXZlU2VsZWN0Lm5hdGl2ZUVsZW1lbnQub3B0aW9uc1tzZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl92YWx1ZSA9IHRhcmdldFZhbDtcbiAgICB9XG5cbiAgICBfY2hhbmdlKGV2ZW50OiBFdmVudCwgdmFsdWU6IGFueSkge1xuICAgICAgICB0aGlzLl92YWx1ZURhdGEgPSB2YWx1ZTtcbiAgICAgICAgLy8gSWYgbmdWYWx1ZSBpcyBiZWluZyB1c2VkLCBwdWxsIHRoYXQgdmFsdWUgZnJvbSB0aGUgZGlyZWN0aXZlIHRvIGFsbG93IG9iamVjdHMgd2VsbCBhcyBzdHJpbmdzXG4gICAgICAgIGlmICh0aGlzLl9vcHRpb25zLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uQXJyYXkgPSB0aGlzLl9vcHRpb25zLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgID8gdGhpcy5fbmF0aXZlU2VsZWN0Lm5hdGl2ZUVsZW1lbnQuc2VsZWN0ZWRJbmRleCAtIDFcbiAgICAgICAgICAgICAgICA6IHRoaXMuX25hdGl2ZVNlbGVjdC5uYXRpdmVFbGVtZW50LnNlbGVjdGVkSW5kZXg7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZURhdGEgPSBvcHRpb25BcnJheVtpbmRleF0ubmdWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuX3ZhbHVlRGF0YSk7XG4gICAgICAgIHRoaXMuY2hhbmdlLmVtaXQobmV3IFNlbGVjdENoYW5nZUV2ZW50KHRoaXMsIHRoaXMuX3ZhbHVlRGF0YSkpO1xuICAgIH1cblxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcbiAgICAgICAgLy8gVGhpcyBuZWVkcyB0byBiZSBjaGVja2VkIGV2ZXJ5IGN5Y2xlIGJlY2F1c2Ugd2UgY2FuJ3Qgc3Vic2NyaWJlIHRvIGZvcm0gc3VibWlzc2lvbnNcbiAgICAgICAgaWYgKHRoaXMuX25nQ29udHJvbCkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlRXJyb3JTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfdXBkYXRlRXJyb3JTdGF0ZSgpIHtcbiAgICAgICAgY29uc3Qgb2xkU3RhdGUgPSB0aGlzLl9lcnJvclN0YXRlO1xuXG4gICAgICAgIC8vIFRPRE86IHRoaXMgY291bGQgYmUgYWJzdHJhY3RlZCBvdXQgYXMgYW4gQElucHV0KCkgaWYgd2UgbmVlZCB0aGlzIHRvIGJlIGNvbmZpZ3VyYWJsZVxuICAgICAgICBjb25zdCBuZXdTdGF0ZSA9ICEhKFxuICAgICAgICAgICAgdGhpcy5fbmdDb250cm9sICYmXG4gICAgICAgICAgICB0aGlzLl9uZ0NvbnRyb2wuaW52YWxpZCAmJlxuICAgICAgICAgICAgKHRoaXMuX25nQ29udHJvbC50b3VjaGVkIHx8ICh0aGlzLl9mb3JtICYmIHRoaXMuX2Zvcm0uc3VibWl0dGVkKSlcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAob2xkU3RhdGUgIT09IG5ld1N0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLl9lcnJvclN0YXRlID0gbmV3U3RhdGU7XG4gICAgICAgIH1cbiAgICB9XG59XG4iXX0=