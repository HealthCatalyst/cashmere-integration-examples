/**
 * @fileoverview added by tsickle
 * Generated from: lib/app-switcher/app-switcher.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { takeUntil } from 'rxjs/operators';
import { Component, Inject, Input, ViewEncapsulation } from '@angular/core';
import { Subject } from 'rxjs';
import { APP_SWITCHER_SERVICE } from './app-switcher-interfaces';
import { WorkTrackerService } from '../shared/work-tracker.service';
export class AppSwitcherComponent {
    /**
     * @param {?} appSwitcherService
     * @param {?} workTracker
     */
    constructor(appSwitcherService, workTracker) {
        this.appSwitcherService = appSwitcherService;
        this.workTracker = workTracker;
        this.brandBg = 'brand';
        this.loadFailed = false;
        this._iconHeight = 60;
        this._serviceName = '';
        this._version = '';
        this.ngUnsubscribe = new Subject();
    }
    /**
     * Sets the height of the app thumbnail icons, width is auto (defaults to 100px)
     * @return {?}
     */
    get iconHeight() {
        return this._iconHeight;
    }
    /**
     * @param {?} heightVal
     * @return {?}
     */
    set iconHeight(heightVal) {
        this._iconHeight = heightVal;
    }
    /**
     * @return {?}
     */
    get serviceName() {
        return this._serviceName;
    }
    /**
     * @param {?} serviceNameVal
     * @return {?}
     */
    set serviceName(serviceNameVal) {
        this._serviceName = serviceNameVal;
    }
    /**
     * @return {?}
     */
    get serviceVersion() {
        return this._version;
    }
    /**
     * @param {?} serviceVersionVal
     * @return {?}
     */
    set serviceVersion(serviceVersionVal) {
        this._version = `${serviceVersionVal}`;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.loadApplications();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.ngUnsubscribe.next();
        this.ngUnsubscribe.complete();
    }
    /**
     * @return {?}
     */
    loadApplications() {
        try {
            this.loadApplicationFromDiscoveryService();
        }
        catch (error) {
            this.handleError(error);
        }
    }
    /**
     * @private
     * @return {?}
     */
    loadApplicationFromDiscoveryService() {
        this.loading = this.workTracker.startObservable((/**
         * @return {?}
         */
        () => this.appSwitcherService
            .getApplications()
            .pipe(takeUntil(this.ngUnsubscribe))
            .subscribe((/**
         * @param {?} response
         * @return {?}
         */
        (response) => {
            this.applications = response.value;
        }), (/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            this.handleError(error);
        }))));
    }
    /**
     * @private
     * @param {?} error
     * @return {?}
     */
    handleError(error) {
        console.error('Failed to load applications from the app switcher service.', error);
        this.loadFailed = true;
    }
    /**
     * @param {?} app
     * @return {?}
     */
    linkIfNotMe(app) {
        return this.appIsMe(app) ? null : app.ServiceUrl;
    }
    /**
     * @param {?} app
     * @return {?}
     */
    appIsMe(app) {
        return app.ServiceName === this.serviceName && `${app.Version}` === this.serviceVersion;
    }
}
AppSwitcherComponent.decorators = [
    { type: Component, args: [{
                selector: 'hc-app-switcher',
                template: "<div class=\"hc-app-switcher\">\n    <h4 class=\"hc-app-switcher-header\">\n        Applications\n        <a\n            hc-button\n            *ngIf=\"appSwitcherService.allApplicationsUri\"\n            buttonStyle=\"link-inline\"\n            class=\"hc-app-switcher-all-apps-link\"\n            [href]=\"appSwitcherService.allApplicationsUri\"\n            target=\"_blank\"\n        >\n            View All\n        </a>\n    </h4>\n\n    <ng-container *ngIf=\"applications?.length > 0\">\n        <div class=\"hc-app-switcher-apps\">\n            <div class=\"hc-app-switcher-app\" *ngFor=\"let app of applications\">\n                <a\n                    class=\"hc-app-switcher-link\"\n                    [ngClass]=\"{'hc-app-switcher-link-highlighted': appIsMe(app)}\"\n                    [title]=\"appIsMe(app) ? 'Current Application' : app.Description\"\n                    [attr.href]=\"linkIfNotMe(app)\"\n                    target=\"_blank\"\n                >\n                    <div\n                        class=\"hc-app-switcher-app-img\"\n                        [ngStyle]=\"{\n                            width: iconHeight + 'px',\n                            height: iconHeight + 'px',\n                            'background-image': 'url(' + app.Icon + ')'\n                        }\"\n                    ></div>\n                    <div class=\"hc-app-switcher-app-title\">{{ app?.FriendlyName | ellipsis: 18 }}</div>\n                </a>\n            </div>\n        </div>\n    </ng-container>\n\n    <!-- Loading -->\n    <div *ngIf=\"loading | async\" class=\"hc-app-switcher-empty hc-app-switcher-spinner-container\">\n        <hc-progress-spinner diameter=\"60\"></hc-progress-spinner>\n    </div>\n\n    <!-- Load Failed -->\n    <div *ngIf=\"!(loading | async) && loadFailed\" class=\"hc-app-switcher-empty\">\n        <span class=\"hc-app-switcher-warning-icon\"></span>\n        <em>Failed to load applications.</em>\n        <a class=\"hc-app-switcher-retry\" hc-button buttonStyle=\"link\" (click)=\"loadApplications()\">Retry now.</a>\n    </div>\n\n    <!-- No Apps Available -->\n    <div *ngIf=\"!(loading | async) && applications?.length === 0\" class=\"hc-app-switcher-empty\">\n        <span class=\"hc-app-switcher-empty-icon\"></span>\n        <em>No applications available.</em>\n    </div>\n</div>\n",
                // tslint:disable-next-line: no-host-metadata-property
                host: { class: 'hc-app-switcher-container' },
                encapsulation: ViewEncapsulation.None,
                styles: [".hc-app-switcher-container{height:100%;width:100%}.hc-app-switcher{max-width:360px}.hc-app-switcher-header{-webkit-box-align:baseline;align-items:baseline;border-bottom:1px solid #ccc;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;margin:10px 0;padding-bottom:5px;padding-left:2px}.hc-app-switcher-all-apps-link{font-size:.92857rem}.hc-app-switcher-apps{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-pack:start;justify-content:flex-start}.hc-app-switcher-app{-webkit-box-flex:0;flex:0 0 auto}.hc-app-switcher-link{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:10px;text-decoration:none}.hc-app-switcher-link-highlighted{opacity:.5}.hc-app-switcher-app-title{color:#333;font-weight:600;padding-top:8px;text-align:center;width:100px}.hc-app-switcher-app-img{background-position:center;background-repeat:no-repeat;background-size:cover}.hc-app-switcher-empty{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:20px;text-align:center;width:360px}.hc-app-switcher-spinner-container{padding:65px 0}.hc-app-switcher-warning-icon{background-repeat:no-repeat;height:40px;opacity:.5;width:40px;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMC4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA3OS41IDcwLjEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDc5LjUgNzAuMTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHRpdGxlPndhcm48L3RpdGxlPg0KPHBhdGggZD0iTTc4LjgsNjIuOEw0NCwyLjRjLTEuMy0yLjMtNC4zLTMuMS02LjctMS44Yy0wLjcsMC40LTEuNCwxLTEuOCwxLjhMMC43LDYyLjhjLTEuMywyLjMtMC41LDUuMywxLjgsNi43DQoJYzAuNywwLjQsMS42LDAuNywyLjQsMC43aDY5LjdjMi43LDAsNC45LTIuMiw0LjktNC45Qzc5LjUsNjQuNCw3OS4yLDYzLjUsNzguOCw2Mi44eiBNMzUuMiwyMC43aDkuMnYyNS43aC05LjJWMjAuN3ogTTM5LjcsNjAuOA0KCWMtMy4xLDAtNS42LTIuNS01LjYtNS42YzAtMy4xLDIuNS01LjYsNS42LTUuNmMzLjEsMCw1LjYsMi41LDUuNiw1LjZDNDUuNCw1OC4yLDQyLjgsNjAuOCwzOS43LDYwLjh6Ii8+DQo8L3N2Zz4NCg==)}.hc-app-switcher-empty-icon{background-repeat:no-repeat;height:40px;opacity:.5;width:40px;background-image:url(data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA5Ni45OSA4NC4xNSI+PHRpdGxlPmVtcHR5PC90aXRsZT48cGF0aCBkPSJNODcuMTQsMTEuNjVhNS41NCw1LjU0LDAsMCwwLTUtMy41N0gxOGE1LjU0LDUuNTQsMCwwLDAtNSwzLjU3TDEuNTYsNTIuM1Y4OC42N2EzLjU3LDMuNTcsMCwwLDAsMy41NywzLjU3SDk1YTMuNTcsMy41NywwLDAsMCwzLjU3LTMuNTdWNTIuM1pNODUuNzIsNTMuNzJINjguNnMtMi4xNC4xOC0yLjE0LDMuNTdsMC0uMDhhMTYuMzgsMTYuMzgsMCwwLDEtMzIuNzQsMGwwLC4wOGMwLTMuMzktMi4xNC0zLjU2LTIuMTQtMy41NkgxNC40Yy01LjcxLDAtMy41Ny01LTMuNTctNWw4LjU2LTMxLjM4QTMuODEsMy44MSwwLDAsMSwyMywxNC41SDc3Ljg3YTMuNzcsMy43NywwLDAsMSwzLjU3LDIuNzlsNy44NSwzMS4zMlM5MS40Miw1My43Miw4NS43Miw1My43MloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xLjU2IC04LjA4KSIvPjwvc3ZnPg==)}.hc-app-switcher-retry{cursor:pointer;font-weight:600;margin-top:10px}"]
            }] }
];
/** @nocollapse */
AppSwitcherComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [APP_SWITCHER_SERVICE,] }] },
    { type: WorkTrackerService }
];
AppSwitcherComponent.propDecorators = {
    iconHeight: [{ type: Input }],
    serviceName: [{ type: Input }],
    serviceVersion: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    AppSwitcherComponent.prototype.applications;
    /** @type {?} */
    AppSwitcherComponent.prototype.subscription;
    /** @type {?} */
    AppSwitcherComponent.prototype.brandBg;
    /** @type {?} */
    AppSwitcherComponent.prototype.loading;
    /** @type {?} */
    AppSwitcherComponent.prototype.loadFailed;
    /**
     * @type {?}
     * @private
     */
    AppSwitcherComponent.prototype._iconHeight;
    /**
     * @type {?}
     * @private
     */
    AppSwitcherComponent.prototype._serviceName;
    /**
     * @type {?}
     * @private
     */
    AppSwitcherComponent.prototype._version;
    /**
     * @type {?}
     * @private
     */
    AppSwitcherComponent.prototype.ngUnsubscribe;
    /** @type {?} */
    AppSwitcherComponent.prototype.appSwitcherService;
    /**
     * @type {?}
     * @private
     */
    AppSwitcherComponent.prototype.workTracker;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLXN3aXRjaGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BoZWFsdGhjYXRhbHlzdC9jYXNobWVyZS8iLCJzb3VyY2VzIjpbImxpYi9hcHAtc3dpdGNoZXIvYXBwLXN3aXRjaGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUN6QyxPQUFPLEVBQUMsU0FBUyxFQUFFLE1BQU0sRUFBcUIsS0FBSyxFQUFFLGlCQUFpQixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzdGLE9BQU8sRUFBQyxPQUFPLEVBQTJCLE1BQU0sTUFBTSxDQUFDO0FBRXZELE9BQU8sRUFBNkMsb0JBQW9CLEVBQUMsTUFBTSwyQkFBMkIsQ0FBQztBQUMzRyxPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSxnQ0FBZ0MsQ0FBQztBQVVsRSxNQUFNLE9BQU8sb0JBQW9COzs7OztJQXNDN0IsWUFBaUQsa0JBQXVDLEVBQVUsV0FBK0I7UUFBaEYsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFxQjtRQUFVLGdCQUFXLEdBQVgsV0FBVyxDQUFvQjtRQW5DMUgsWUFBTyxHQUFHLE9BQU8sQ0FBQztRQUVsQixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBQ2xCLGdCQUFXLEdBQVcsRUFBRSxDQUFDO1FBQ3pCLGlCQUFZLEdBQVcsRUFBRSxDQUFDO1FBQzFCLGFBQVEsR0FBVyxFQUFFLENBQUM7UUFFdEIsa0JBQWEsR0FBUSxJQUFJLE9BQU8sRUFBRSxDQUFDO0lBNEJ5RixDQUFDOzs7OztJQXpCckksSUFDSSxVQUFVO1FBQ1YsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7Ozs7O0lBRUQsSUFBSSxVQUFVLENBQUMsU0FBaUI7UUFDNUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxTQUFTLENBQUM7SUFDakMsQ0FBQzs7OztJQUVELElBQ0ksV0FBVztRQUNYLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQztJQUM3QixDQUFDOzs7OztJQUVELElBQUksV0FBVyxDQUFDLGNBQXNCO1FBQ2xDLElBQUksQ0FBQyxZQUFZLEdBQUcsY0FBYyxDQUFDO0lBQ3ZDLENBQUM7Ozs7SUFDRCxJQUNJLGNBQWM7UUFDZCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDekIsQ0FBQzs7Ozs7SUFFRCxJQUFJLGNBQWMsQ0FBQyxpQkFBa0M7UUFDakQsSUFBSSxDQUFDLFFBQVEsR0FBRyxHQUFHLGlCQUFpQixFQUFFLENBQUM7SUFDM0MsQ0FBQzs7OztJQUdELFFBQVE7UUFDSixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUM1QixDQUFDOzs7O0lBRUQsV0FBVztRQUNQLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDMUIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNsQyxDQUFDOzs7O0lBRU0sZ0JBQWdCO1FBQ25CLElBQUk7WUFDQSxJQUFJLENBQUMsbUNBQW1DLEVBQUUsQ0FBQztTQUM5QztRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ1osSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUMzQjtJQUNMLENBQUM7Ozs7O0lBRU8sbUNBQW1DO1FBQ3ZDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxlQUFlOzs7UUFBQyxHQUFHLEVBQUUsQ0FDakQsSUFBSSxDQUFDLGtCQUFrQjthQUNsQixlQUFlLEVBQUU7YUFDakIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7YUFDbkMsU0FBUzs7OztRQUNOLENBQUMsUUFBYSxFQUFFLEVBQUU7WUFDZCxJQUFJLENBQUMsWUFBWSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUM7UUFDdkMsQ0FBQzs7OztRQUNELENBQUMsS0FBVSxFQUFFLEVBQUU7WUFDWCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLENBQUMsRUFDSixFQUNSLENBQUM7SUFDTixDQUFDOzs7Ozs7SUFFTyxXQUFXLENBQUMsS0FBVTtRQUMxQixPQUFPLENBQUMsS0FBSyxDQUFDLDREQUE0RCxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ25GLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0lBQzNCLENBQUM7Ozs7O0lBRUQsV0FBVyxDQUFDLEdBQUc7UUFDWCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQztJQUNyRCxDQUFDOzs7OztJQUVELE9BQU8sQ0FBQyxHQUEwQjtRQUM5QixPQUFPLEdBQUcsQ0FBQyxXQUFXLEtBQUssSUFBSSxDQUFDLFdBQVcsSUFBSSxHQUFHLEdBQUcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzVGLENBQUM7OztZQTVGSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLGlCQUFpQjtnQkFDM0IscTBFQUE0Qzs7Z0JBRzVDLElBQUksRUFBRSxFQUFDLEtBQUssRUFBRSwyQkFBMkIsRUFBQztnQkFDMUMsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7O2FBQ3hDOzs7OzRDQXVDZ0IsTUFBTSxTQUFDLG9CQUFvQjtZQWhEcEMsa0JBQWtCOzs7eUJBdUJyQixLQUFLOzBCQVNMLEtBQUs7NkJBUUwsS0FBSzs7OztJQTdCTiw0Q0FBNkM7O0lBQzdDLDRDQUFrQzs7SUFDbEMsdUNBQXlCOztJQUN6Qix1Q0FBb0M7O0lBQ3BDLDBDQUEwQjs7Ozs7SUFDMUIsMkNBQWlDOzs7OztJQUNqQyw0Q0FBa0M7Ozs7O0lBQ2xDLHdDQUE4Qjs7Ozs7SUFFOUIsNkNBQTJDOztJQTRCL0Isa0RBQTRFOzs7OztJQUFFLDJDQUF1QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7dGFrZVVudGlsfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0NvbXBvbmVudCwgSW5qZWN0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgSW5wdXQsIFZpZXdFbmNhcHN1bGF0aW9ufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7U3ViamVjdCwgU3Vic2NyaXB0aW9uLCBPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHtJQXBwU3dpdGNoZXJTZXJ2aWNlLCBJRGlzY292ZXJ5QXBwbGljYXRpb24sIEFQUF9TV0lUQ0hFUl9TRVJWSUNFfSBmcm9tICcuL2FwcC1zd2l0Y2hlci1pbnRlcmZhY2VzJztcbmltcG9ydCB7V29ya1RyYWNrZXJTZXJ2aWNlfSBmcm9tICcuLi9zaGFyZWQvd29yay10cmFja2VyLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2hjLWFwcC1zd2l0Y2hlcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2FwcC1zd2l0Y2hlci5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vYXBwLXN3aXRjaGVyLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1ob3N0LW1ldGFkYXRhLXByb3BlcnR5XG4gICAgaG9zdDoge2NsYXNzOiAnaGMtYXBwLXN3aXRjaGVyLWNvbnRhaW5lcid9LFxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcbn0pXG5leHBvcnQgY2xhc3MgQXBwU3dpdGNoZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gICAgcHVibGljIGFwcGxpY2F0aW9uczogSURpc2NvdmVyeUFwcGxpY2F0aW9uW107XG4gICAgcHVibGljIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICAgIHB1YmxpYyBicmFuZEJnID0gJ2JyYW5kJztcbiAgICBwdWJsaWMgbG9hZGluZzogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgICBwdWJsaWMgbG9hZEZhaWxlZCA9IGZhbHNlO1xuICAgIHByaXZhdGUgX2ljb25IZWlnaHQ6IG51bWJlciA9IDYwO1xuICAgIHByaXZhdGUgX3NlcnZpY2VOYW1lOiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIF92ZXJzaW9uOiBzdHJpbmcgPSAnJztcblxuICAgIHByaXZhdGUgbmdVbnN1YnNjcmliZTogYW55ID0gbmV3IFN1YmplY3QoKTtcblxuICAgIC8qKiBTZXRzIHRoZSBoZWlnaHQgb2YgdGhlIGFwcCB0aHVtYm5haWwgaWNvbnMsIHdpZHRoIGlzIGF1dG8gKGRlZmF1bHRzIHRvIDEwMHB4KSAqL1xuICAgIEBJbnB1dCgpXG4gICAgZ2V0IGljb25IZWlnaHQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ljb25IZWlnaHQ7XG4gICAgfVxuXG4gICAgc2V0IGljb25IZWlnaHQoaGVpZ2h0VmFsOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5faWNvbkhlaWdodCA9IGhlaWdodFZhbDtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIGdldCBzZXJ2aWNlTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZU5hbWU7XG4gICAgfVxuXG4gICAgc2V0IHNlcnZpY2VOYW1lKHNlcnZpY2VOYW1lVmFsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZVZhbDtcbiAgICB9XG4gICAgQElucHV0KClcbiAgICBnZXQgc2VydmljZVZlcnNpb24oKTogc3RyaW5nIHwgbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZlcnNpb247XG4gICAgfVxuXG4gICAgc2V0IHNlcnZpY2VWZXJzaW9uKHNlcnZpY2VWZXJzaW9uVmFsOiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fdmVyc2lvbiA9IGAke3NlcnZpY2VWZXJzaW9uVmFsfWA7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKEBJbmplY3QoQVBQX1NXSVRDSEVSX1NFUlZJQ0UpIHB1YmxpYyBhcHBTd2l0Y2hlclNlcnZpY2U6IElBcHBTd2l0Y2hlclNlcnZpY2UsIHByaXZhdGUgd29ya1RyYWNrZXI6IFdvcmtUcmFja2VyU2VydmljZSkge31cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmxvYWRBcHBsaWNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5uZ1Vuc3Vic2NyaWJlLm5leHQoKTtcbiAgICAgICAgdGhpcy5uZ1Vuc3Vic2NyaWJlLmNvbXBsZXRlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGxvYWRBcHBsaWNhdGlvbnMoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRBcHBsaWNhdGlvbkZyb21EaXNjb3ZlcnlTZXJ2aWNlKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgbG9hZEFwcGxpY2F0aW9uRnJvbURpc2NvdmVyeVNlcnZpY2UoKSB7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IHRoaXMud29ya1RyYWNrZXIuc3RhcnRPYnNlcnZhYmxlKCgpID0+XG4gICAgICAgICAgICB0aGlzLmFwcFN3aXRjaGVyU2VydmljZVxuICAgICAgICAgICAgICAgIC5nZXRBcHBsaWNhdGlvbnMoKVxuICAgICAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLm5nVW5zdWJzY3JpYmUpKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgICAgIChyZXNwb25zZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9ucyA9IHJlc3BvbnNlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAoZXJyb3I6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVFcnJvcihlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGFwcGxpY2F0aW9ucyBmcm9tIHRoZSBhcHAgc3dpdGNoZXIgc2VydmljZS4nLCBlcnJvcik7XG4gICAgICAgIHRoaXMubG9hZEZhaWxlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgbGlua0lmTm90TWUoYXBwKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwSXNNZShhcHApID8gbnVsbCA6IGFwcC5TZXJ2aWNlVXJsO1xuICAgIH1cblxuICAgIGFwcElzTWUoYXBwOiBJRGlzY292ZXJ5QXBwbGljYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIGFwcC5TZXJ2aWNlTmFtZSA9PT0gdGhpcy5zZXJ2aWNlTmFtZSAmJiBgJHthcHAuVmVyc2lvbn1gID09PSB0aGlzLnNlcnZpY2VWZXJzaW9uO1xuICAgIH1cbn1cbiJdfQ==