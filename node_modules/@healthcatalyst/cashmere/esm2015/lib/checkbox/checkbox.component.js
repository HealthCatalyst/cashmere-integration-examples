/**
 * @fileoverview added by tsickle
 * Generated from: lib/checkbox/checkbox.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Attribute, Component, ElementRef, EventEmitter, forwardRef, HostBinding, Input, Output, Renderer2, ViewChild, ViewEncapsulation, Self, Optional } from '@angular/core';
import { NgForm, FormGroupDirective, NgControl } from '@angular/forms';
import { HcFormControlComponent } from '../form-field/hc-form-control.component';
import { parseBooleanAttribute } from '../util';
/** @type {?} */
let nextCheckboxId = 1;
export class CheckboxChangeEvent {
    /**
     * @param {?} source
     * @param {?} checked
     */
    constructor(source, checked) {
        this.source = source;
        this.checked = checked;
    }
}
if (false) {
    /** @type {?} */
    CheckboxChangeEvent.prototype.source;
    /** @type {?} */
    CheckboxChangeEvent.prototype.checked;
}
export class CheckboxComponent extends HcFormControlComponent {
    /**
     * @param {?} tabindex
     * @param {?} _renderer
     * @param {?} _elementRef
     * @param {?} _parentForm
     * @param {?} _parentFormGroup
     * @param {?} _ngControl
     */
    constructor(tabindex, _renderer, _elementRef, _parentForm, _parentFormGroup, _ngControl) {
        super();
        this._renderer = _renderer;
        this._elementRef = _elementRef;
        this._ngControl = _ngControl;
        this._uniqueId = `hc-checkbox-${nextCheckboxId++}`;
        this._checked = false;
        this._tight = false;
        this._componentId = this._uniqueId;
        /**
         * If true, the checkbox is for display purposes (not user interaction). As such its checked/unchecked state
         * can only be controlled programatically. Useful for embedding in an ng-select typeahead
         */
        this.isStub = false;
        /**
         * Sets the position of the checkbox relative to its associated label. *Defaults to `center`.*
         */
        this.align = 'center';
        /**
         * Sets unique name used in a form
         */
        this.name = null;
        /**
         * Event emitted whenever the state changes
         */
        this.change = new EventEmitter();
        this._onChangeFunc = (/**
         * @return {?}
         */
        () => { });
        this._onTouchFunc = (/**
         * @return {?}
         */
        () => { });
        this.tabIndex = parseInt(tabindex, 10) || 0;
        this._form = _parentForm || _parentFormGroup;
        if (this._ngControl != null) {
            this._ngControl.valueAccessor = this;
        }
    }
    /**
     * Unique id for the checkbox element. If none is supplied, one will be auto-generated.
     * @return {?}
     */
    get id() {
        return this._componentId || this._uniqueId;
    }
    /**
     * @param {?} idVal
     * @return {?}
     */
    set id(idVal) {
        this._componentId = idVal ? idVal : this._uniqueId;
    }
    /**
     * If true, condense the default margin and reduce the font size. *Defaults to `false`.*
     * @return {?}
     */
    get tight() {
        return this._tight;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set tight(value) {
        this._tight = parseBooleanAttribute(value);
    }
    /**
     * @return {?}
     */
    get _getHostId() {
        return this.id;
    }
    /**
     * @return {?}
     */
    get _getCheckboxCheckedClass() {
        return this.checked;
    }
    /**
     * @return {?}
     */
    get _getCheckboxDisabledClass() {
        if (this._ngControl && this._ngControl.disabled) {
            return this._ngControl.disabled;
        }
        return this._isDisabled;
    }
    /**
     * @return {?}
     */
    get _getCheckboxIndeterminateClass() {
        return this.indeterminate;
    }
    /**
     * Whether the checkbox is required.
     * @return {?}
     */
    get required() {
        return this._isRequired;
    }
    /**
     * @param {?} requiredVal
     * @return {?}
     */
    set required(requiredVal) {
        this._isRequired = parseBooleanAttribute(requiredVal);
    }
    /**
     * Whether the checkbox is disabled.
     * @return {?}
     */
    get disabled() {
        if (this._ngControl && this._ngControl.disabled) {
            return this._ngControl.disabled;
        }
        return this._isDisabled;
    }
    /**
     * @param {?} disabledVal
     * @return {?}
     */
    set disabled(disabledVal) {
        this._isDisabled = parseBooleanAttribute(disabledVal);
    }
    /**
     * Whether the checkbox is checked.
     * @return {?}
     */
    get checked() {
        return this._checked;
    }
    /**
     * @param {?} checked
     * @return {?}
     */
    set checked(checked) {
        if (this._checked === checked) {
            return;
        }
        this._checked = checked;
    }
    /**
     * TabIndex attribute of native checkbox
     * @return {?}
     */
    get tabIndex() {
        return this._isDisabled ? -1 : this._tabIndex;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set tabIndex(value) {
        this._tabIndex = value == null ? 0 : value;
    }
    /**
     * @return {?}
     */
    get _inputId() {
        return `${this.id || this._uniqueId}-input`;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        this.checked = !!value;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this._onChangeFunc = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this._onTouchFunc = fn;
    }
    /**
     * @param {?} disabledVal
     * @return {?}
     */
    setDisabledState(disabledVal) {
        this.disabled = disabledVal;
        this._renderer.setProperty(this._checkboxInput.nativeElement, 'disabled', disabledVal);
    }
    /**
     * Toggles the current checked state of the checkbox
     * @return {?}
     */
    toggle() {
        this.checked = !this.checked;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    _clickEvent(event) {
        event.stopPropagation(); // prevent native click event from being dispatched
        if (!this.disabled) {
            this.toggle();
            this._emitChangeEvent();
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    _stopChangeEvent(event) {
        event.stopPropagation(); // prevent native change event from emitting its own object through output 'change'
    }
    /**
     * @private
     * @return {?}
     */
    _emitChangeEvent() {
        this._onChangeFunc(this.checked);
        this.change.emit(new CheckboxChangeEvent(this, this.checked));
    }
    /**
     * @return {?}
     */
    _onBlur() {
        this._onTouchFunc();
    }
    /**
     * @return {?}
     */
    ngDoCheck() {
        // This needs to be checked every cycle because we can't subscribe to form submissions
        if (this._ngControl) {
            this._updateErrorState();
        }
    }
    /**
     * @private
     * @return {?}
     */
    _updateErrorState() {
        /** @type {?} */
        const oldState = this._errorState;
        // TODO: this could be abstracted out as an @Input() if we need this to be configurable
        /** @type {?} */
        const newState = !!(this._ngControl &&
            this._ngControl.invalid &&
            (this._ngControl.touched || (this._form && this._form.submitted)));
        if (oldState !== newState) {
            this._errorState = newState;
        }
    }
}
CheckboxComponent.decorators = [
    { type: Component, args: [{
                selector: 'hc-checkbox',
                template: "<div class=\"hc-checkbox-container\" [class.hc-checkbox-stub]=\"isStub\">\n    <div class=\"hc-checkbox-content\" [class.hc-checkbox-tight]=\"tight\" [ngClass]=\"'hc-checkbox-align-'+align\">\n        <input #checkboxInput\n               type=\"checkbox\"\n               [id]=\"_inputId\"\n               [attr.value]=\"value\"\n               [attr.name]=\"name\"\n               [tabIndex]=\"tabIndex\"\n               [indeterminate]=\"indeterminate\"\n               [disabled]=\"disabled\"\n               [required]=\"required\"\n               [checked]=\"checked\"\n               (change)=\"_stopChangeEvent($event)\"\n               (click)=\"_clickEvent($event)\"\n               (blur)=\"_onBlur()\"/>\n        <label class=\"hc-checkbox-overlay\" [attr.for]=\"_inputId\"></label>\n        <label class=\"hc-checkbox-label\" [ngClass]=\"'hc-checkbox-align-label-'+align\" [attr.for]=\"_inputId\">\n            <ng-content></ng-content>\n        </label>\n    </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                providers: [{ provide: HcFormControlComponent, useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => CheckboxComponent)) }],
                exportAs: 'hcCheckbox',
                styles: [".hc-checkbox-container{overflow:hidden;display:-webkit-box;display:flex}.hc-checkbox-container input[type=checkbox]{display:none}.hc-checkbox-content{display:-webkit-inline-box;display:inline-flex;cursor:pointer}.hc-checkbox-content label{cursor:pointer}.hc-checkbox-disabled .hc-checkbox-content{color:#ccc;cursor:not-allowed}.hc-checkbox-disabled .hc-checkbox-content label{cursor:not-allowed}.hc-checkbox-align-center{-webkit-box-align:center;align-items:center}.hc-checkbox-align-top{-webkit-box-align:start;align-items:flex-start}.hc-checkbox-align-bottom{-webkit-box-align:end;align-items:flex-end}.hc-checkbox-label{padding:4px 0 4px 34px;line-height:1.5;position:relative;left:-22px}.hc-checkbox-tight .hc-checkbox-label{padding:2px 0 2px 26px;font-size:.92857rem;left:-18px}.hc-checkbox-align-label-top{padding-top:0!important;margin-top:-3px}.hc-checkbox-align-label-bottom{padding-bottom:0!important;margin-bottom:-3px}.hc-checkbox-overlay{position:relative;width:22px;height:22px;min-width:22px;background-color:#fff;border:2px solid #ccc;border-radius:3px}.hc-checkbox-overlay:after{content:'';position:absolute;background-image:url(data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMCAzMCI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiNmZmY7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5BcnRib2FyZCAxPC90aXRsZT48cGF0aCBpZD0iUGF0aF8xMjIyMSIgZGF0YS1uYW1lPSJQYXRoIDEyMjIxIiBjbGFzcz0iY2xzLTEiIGQ9Ik0yOCw5Ljc2YTEuNjYsMS42NiwwLDAsMC0uNDYtMS4xNEwyNS4yMyw2LjM1YTEuNjIsMS42MiwwLDAsMC0yLjI4LDBsLTExLDExTDcuMDUsMTIuNDFhMS42MiwxLjYyLDAsMCwwLTIuMjgsMEwyLjQ5LDE0LjY4QTEuNjcsMS42NywwLDAsMCwyLDE1LjgyLDEuNjYsMS42NiwwLDAsMCwyLjQ5LDE3TDguNTUsMjNsMi4yOCwyLjI4YTEuNjEsMS42MSwwLDAsMCwxLjE0LjQ3LDEuNjMsMS42MywwLDAsMCwxLjE0LS40N0wxNS4zOSwyMywyNy41MSwxMC45QTEuNiwxLjYsMCwwLDAsMjgsOS43NloiLz48L3N2Zz4=);top:1px;left:1.5px;width:15.5px;height:15.5px;opacity:0}.hc-checkbox-tight .hc-checkbox-overlay{width:18px;height:18px;min-width:18px}.hc-checkbox-tight .hc-checkbox-overlay:after{top:.5px;left:.5px;width:12.5px;height:12.5px}.hc-checkbox-content:hover .hc-checkbox-overlay{border:2px solid #00aeff}.hc-checkbox-indeterminate .hc-checkbox-overlay:after{opacity:1;top:3.5px;left:3px;width:12px;height:7px;border-bottom:3px solid #ccc;background-image:none}.hc-checkbox-indeterminate .hc-checkbox-tight .hc-checkbox-overlay:after{top:1.5px;width:8px}input[type=checkbox]:checked+.hc-checkbox-overlay{background-color:#00aeff;border-color:#00aeff}input[type=checkbox]:checked+.hc-checkbox-overlay:after{opacity:1}.hc-checkbox-disabled input[type=checkbox]+.hc-checkbox-overlay{background-color:#e0e0e0;border:2px solid #ccc}.hc-form-field-invalid .hc-checkbox-overlay{border-color:#cc2027!important}.hc-checkbox-stub .hc-checkbox-label,.hc-checkbox-stub .hc-checkbox-overlay{pointer-events:none}"]
            }] }
];
/** @nocollapse */
CheckboxComponent.ctorParameters = () => [
    { type: String, decorators: [{ type: Attribute, args: ['tabindex',] }] },
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgForm, decorators: [{ type: Optional }] },
    { type: FormGroupDirective, decorators: [{ type: Optional }] },
    { type: NgControl, decorators: [{ type: Optional }, { type: Self }] }
];
CheckboxComponent.propDecorators = {
    value: [{ type: Input }],
    indeterminate: [{ type: Input }],
    isStub: [{ type: Input }],
    id: [{ type: Input }],
    tight: [{ type: Input }],
    align: [{ type: Input }],
    name: [{ type: Input }],
    change: [{ type: Output }],
    _checkboxInput: [{ type: ViewChild, args: ['checkboxInput', { static: true },] }],
    _getHostId: [{ type: HostBinding, args: ['attr.id',] }],
    _getCheckboxCheckedClass: [{ type: HostBinding, args: ['class.hc-checkbox-checked',] }],
    _getCheckboxDisabledClass: [{ type: HostBinding, args: ['class.hc-checkbox-disabled',] }],
    _getCheckboxIndeterminateClass: [{ type: HostBinding, args: ['class.hc-checkbox-indeterminate',] }],
    required: [{ type: Input }],
    disabled: [{ type: Input }],
    checked: [{ type: Input }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._uniqueId;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._form;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._checked;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._tabIndex;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._tight;
    /** @type {?} */
    CheckboxComponent.prototype._componentId;
    /**
     * Value attribute of the native checkbox
     * @type {?}
     */
    CheckboxComponent.prototype.value;
    /**
     * Whether the checkbox is indeterminate. It can represent a checkbox with three states.
     * @type {?}
     */
    CheckboxComponent.prototype.indeterminate;
    /**
     * If true, the checkbox is for display purposes (not user interaction). As such its checked/unchecked state
     * can only be controlled programatically. Useful for embedding in an ng-select typeahead
     * @type {?}
     */
    CheckboxComponent.prototype.isStub;
    /**
     * Sets the position of the checkbox relative to its associated label. *Defaults to `center`.*
     * @type {?}
     */
    CheckboxComponent.prototype.align;
    /**
     * Sets unique name used in a form
     * @type {?}
     */
    CheckboxComponent.prototype.name;
    /**
     * Event emitted whenever the state changes
     * @type {?}
     */
    CheckboxComponent.prototype.change;
    /** @type {?} */
    CheckboxComponent.prototype._checkboxInput;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._onChangeFunc;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._onTouchFunc;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    CheckboxComponent.prototype._elementRef;
    /** @type {?} */
    CheckboxComponent.prototype._ngControl;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tib3guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGhlYWx0aGNhdGFseXN0L2Nhc2htZXJlLyIsInNvdXJjZXMiOlsibGliL2NoZWNrYm94L2NoZWNrYm94LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQ1QsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osVUFBVSxFQUNWLFdBQVcsRUFDWCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFNBQVMsRUFDVCxTQUFTLEVBQ1QsaUJBQWlCLEVBQ2pCLElBQUksRUFDSixRQUFRLEVBRVgsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF1QixNQUFNLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0YsT0FBTyxFQUFDLHNCQUFzQixFQUFDLE1BQU0seUNBQXlDLENBQUM7QUFDL0UsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sU0FBUyxDQUFDOztJQUUxQyxjQUFjLEdBQUcsQ0FBQztBQUV0QixNQUFNLE9BQU8sbUJBQW1COzs7OztJQUM1QixZQUFtQixNQUF5QixFQUFTLE9BQWdCO1FBQWxELFdBQU0sR0FBTixNQUFNLENBQW1CO1FBQVMsWUFBTyxHQUFQLE9BQU8sQ0FBUztJQUFHLENBQUM7Q0FDNUU7OztJQURlLHFDQUFnQzs7SUFBRSxzQ0FBdUI7O0FBV3pFLE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxzQkFBc0I7Ozs7Ozs7OztJQW9JekQsWUFDMkIsUUFBZ0IsRUFDL0IsU0FBb0IsRUFDcEIsV0FBdUIsRUFDbkIsV0FBbUIsRUFDbkIsZ0JBQW9DLEVBR3pDLFVBQXFCO1FBRTVCLEtBQUssRUFBRSxDQUFDO1FBUkEsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNwQixnQkFBVyxHQUFYLFdBQVcsQ0FBWTtRQUt4QixlQUFVLEdBQVYsVUFBVSxDQUFXO1FBM0l4QixjQUFTLEdBQUcsZUFB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NEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIEF0dHJpYnV0ZSxcbiAgICBDb21wb25lbnQsXG4gICAgRWxlbWVudFJlZixcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgZm9yd2FyZFJlZixcbiAgICBIb3N0QmluZGluZyxcbiAgICBJbnB1dCxcbiAgICBPdXRwdXQsXG4gICAgUmVuZGVyZXIyLFxuICAgIFZpZXdDaGlsZCxcbiAgICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgICBTZWxmLFxuICAgIE9wdGlvbmFsLFxuICAgIERvQ2hlY2tcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0Zvcm0sIEZvcm1Hcm91cERpcmVjdGl2ZSwgTmdDb250cm9sfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0hjRm9ybUNvbnRyb2xDb21wb25lbnR9IGZyb20gJy4uL2Zvcm0tZmllbGQvaGMtZm9ybS1jb250cm9sLmNvbXBvbmVudCc7XG5pbXBvcnQge3BhcnNlQm9vbGVhbkF0dHJpYnV0ZX0gZnJvbSAnLi4vdXRpbCc7XG5cbmxldCBuZXh0Q2hlY2tib3hJZCA9IDE7XG5cbmV4cG9ydCBjbGFzcyBDaGVja2JveENoYW5nZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc291cmNlOiBDaGVja2JveENvbXBvbmVudCwgcHVibGljIGNoZWNrZWQ6IGJvb2xlYW4pIHt9XG59XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnaGMtY2hlY2tib3gnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9jaGVja2JveC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vY2hlY2tib3guY29tcG9uZW50LnNjc3MnXSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgIHByb3ZpZGVyczogW3twcm92aWRlOiBIY0Zvcm1Db250cm9sQ29tcG9uZW50LCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBDaGVja2JveENvbXBvbmVudCl9XSxcbiAgICBleHBvcnRBczogJ2hjQ2hlY2tib3gnXG59KVxuZXhwb3J0IGNsYXNzIENoZWNrYm94Q29tcG9uZW50IGV4dGVuZHMgSGNGb3JtQ29udHJvbENvbXBvbmVudCBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBEb0NoZWNrIHtcbiAgICBwcml2YXRlIF91bmlxdWVJZCA9IGBoYy1jaGVja2JveC0ke25leHRDaGVja2JveElkKyt9YDtcbiAgICBwcml2YXRlIF9mb3JtOiBOZ0Zvcm0gfCBGb3JtR3JvdXBEaXJlY3RpdmUgfCBudWxsO1xuICAgIHByaXZhdGUgX2NoZWNrZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIF90YWJJbmRleDogbnVtYmVyO1xuICAgIHByaXZhdGUgX3RpZ2h0OiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBfY29tcG9uZW50SWQgPSB0aGlzLl91bmlxdWVJZDtcblxuICAgIC8qKiBWYWx1ZSBhdHRyaWJ1dGUgb2YgdGhlIG5hdGl2ZSBjaGVja2JveCAqL1xuICAgIEBJbnB1dCgpXG4gICAgdmFsdWU6IHN0cmluZztcblxuICAgIC8qKiBXaGV0aGVyIHRoZSBjaGVja2JveCBpcyBpbmRldGVybWluYXRlLiBJdCBjYW4gcmVwcmVzZW50IGEgY2hlY2tib3ggd2l0aCB0aHJlZSBzdGF0ZXMuICovXG4gICAgQElucHV0KClcbiAgICBpbmRldGVybWluYXRlOiBib29sZWFuO1xuXG4gICAgLyoqIElmIHRydWUsIHRoZSBjaGVja2JveCBpcyBmb3IgZGlzcGxheSBwdXJwb3NlcyAobm90IHVzZXIgaW50ZXJhY3Rpb24pLiBBcyBzdWNoIGl0cyBjaGVja2VkL3VuY2hlY2tlZCBzdGF0ZVxuICAgICAqIGNhbiBvbmx5IGJlIGNvbnRyb2xsZWQgcHJvZ3JhbWF0aWNhbGx5LiBVc2VmdWwgZm9yIGVtYmVkZGluZyBpbiBhbiBuZy1zZWxlY3QgdHlwZWFoZWFkICovXG4gICAgQElucHV0KClcbiAgICBpc1N0dWIgPSBmYWxzZTtcblxuICAgIC8qKiBVbmlxdWUgaWQgZm9yIHRoZSBjaGVja2JveCBlbGVtZW50LiBJZiBub25lIGlzIHN1cHBsaWVkLCBvbmUgd2lsbCBiZSBhdXRvLWdlbmVyYXRlZC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBpZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50SWQgfHwgdGhpcy5fdW5pcXVlSWQ7XG4gICAgfVxuXG4gICAgc2V0IGlkKGlkVmFsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50SWQgPSBpZFZhbCA/IGlkVmFsIDogdGhpcy5fdW5pcXVlSWQ7XG4gICAgfVxuXG4gICAgLyoqIElmIHRydWUsIGNvbmRlbnNlIHRoZSBkZWZhdWx0IG1hcmdpbiBhbmQgcmVkdWNlIHRoZSBmb250IHNpemUuICpEZWZhdWx0cyB0byBgZmFsc2VgLiogICovXG4gICAgQElucHV0KClcbiAgICBnZXQgdGlnaHQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aWdodDtcbiAgICB9XG4gICAgc2V0IHRpZ2h0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3RpZ2h0ID0gcGFyc2VCb29sZWFuQXR0cmlidXRlKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKiogU2V0cyB0aGUgcG9zaXRpb24gb2YgdGhlIGNoZWNrYm94IHJlbGF0aXZlIHRvIGl0cyBhc3NvY2lhdGVkIGxhYmVsLiAqRGVmYXVsdHMgdG8gYGNlbnRlcmAuKiAgKi9cbiAgICBASW5wdXQoKVxuICAgIGFsaWduOiAnY2VudGVyJyB8ICd0b3AnIHwgJ2JvdHRvbScgPSAnY2VudGVyJztcblxuICAgIC8qKiBTZXRzIHVuaXF1ZSBuYW1lIHVzZWQgaW4gYSBmb3JtICovXG4gICAgQElucHV0KClcbiAgICBuYW1lOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgIC8qKiBFdmVudCBlbWl0dGVkIHdoZW5ldmVyIHRoZSBzdGF0ZSBjaGFuZ2VzICovXG4gICAgQE91dHB1dCgpXG4gICAgY2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxDaGVja2JveENoYW5nZUV2ZW50PigpO1xuXG4gICAgQFZpZXdDaGlsZCgnY2hlY2tib3hJbnB1dCcsIHtzdGF0aWM6IHRydWV9KVxuICAgIF9jaGVja2JveElucHV0OiBFbGVtZW50UmVmO1xuXG4gICAgQEhvc3RCaW5kaW5nKCdhdHRyLmlkJylcbiAgICBnZXQgX2dldEhvc3RJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5pZDtcbiAgICB9XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmhjLWNoZWNrYm94LWNoZWNrZWQnKVxuICAgIGdldCBfZ2V0Q2hlY2tib3hDaGVja2VkQ2xhc3MoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrZWQ7XG4gICAgfVxuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYy1jaGVja2JveC1kaXNhYmxlZCcpXG4gICAgZ2V0IF9nZXRDaGVja2JveERpc2FibGVkQ2xhc3MoKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wgJiYgdGhpcy5fbmdDb250cm9sLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmdDb250cm9sLmRpc2FibGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0Rpc2FibGVkO1xuICAgIH1cblxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuaGMtY2hlY2tib3gtaW5kZXRlcm1pbmF0ZScpXG4gICAgZ2V0IF9nZXRDaGVja2JveEluZGV0ZXJtaW5hdGVDbGFzcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXRlcm1pbmF0ZTtcbiAgICB9XG5cbiAgICAvKiogV2hldGhlciB0aGUgY2hlY2tib3ggaXMgcmVxdWlyZWQuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgcmVxdWlyZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1JlcXVpcmVkO1xuICAgIH1cblxuICAgIHNldCByZXF1aXJlZChyZXF1aXJlZFZhbCkge1xuICAgICAgICB0aGlzLl9pc1JlcXVpcmVkID0gcGFyc2VCb29sZWFuQXR0cmlidXRlKHJlcXVpcmVkVmFsKTtcbiAgICB9XG5cbiAgICAvKiogV2hldGhlciB0aGUgY2hlY2tib3ggaXMgZGlzYWJsZWQuICovXG4gICAgQElucHV0KClcbiAgICBnZXQgZGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wgJiYgdGhpcy5fbmdDb250cm9sLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmdDb250cm9sLmRpc2FibGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0Rpc2FibGVkO1xuICAgIH1cblxuICAgIHNldCBkaXNhYmxlZChkaXNhYmxlZFZhbCkge1xuICAgICAgICB0aGlzLl9pc0Rpc2FibGVkID0gcGFyc2VCb29sZWFuQXR0cmlidXRlKGRpc2FibGVkVmFsKTtcbiAgICB9XG5cbiAgICAvKiogV2hldGhlciB0aGUgY2hlY2tib3ggaXMgY2hlY2tlZC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGdldCBjaGVja2VkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tlZDtcbiAgICB9XG5cbiAgICBzZXQgY2hlY2tlZChjaGVja2VkOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh0aGlzLl9jaGVja2VkID09PSBjaGVja2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2hlY2tlZCA9IGNoZWNrZWQ7XG4gICAgfVxuXG4gICAgLyoqIFRhYkluZGV4IGF0dHJpYnV0ZSBvZiBuYXRpdmUgY2hlY2tib3ggKi9cbiAgICBnZXQgdGFiSW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRGlzYWJsZWQgPyAtMSA6IHRoaXMuX3RhYkluZGV4O1xuICAgIH1cblxuICAgIHNldCB0YWJJbmRleCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuX3RhYkluZGV4ID0gdmFsdWUgPT0gbnVsbCA/IDAgOiB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXQgX2lucHV0SWQoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmlkIHx8IHRoaXMuX3VuaXF1ZUlkfS1pbnB1dGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfb25DaGFuZ2VGdW5jOiAodmFsdWU6IGFueSkgPT4gdm9pZCA9ICgpID0+IHt9O1xuXG4gICAgcHJpdmF0ZSBfb25Ub3VjaEZ1bmM6ICgpID0+IGFueSA9ICgpID0+IHt9O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIEBBdHRyaWJ1dGUoJ3RhYmluZGV4JykgdGFiaW5kZXg6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBfcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICAgICAgcHJpdmF0ZSBfZWxlbWVudFJlZjogRWxlbWVudFJlZixcbiAgICAgICAgQE9wdGlvbmFsKCkgX3BhcmVudEZvcm06IE5nRm9ybSxcbiAgICAgICAgQE9wdGlvbmFsKCkgX3BhcmVudEZvcm1Hcm91cDogRm9ybUdyb3VwRGlyZWN0aXZlLFxuICAgICAgICBAT3B0aW9uYWwoKVxuICAgICAgICBAU2VsZigpXG4gICAgICAgIHB1YmxpYyBfbmdDb250cm9sOiBOZ0NvbnRyb2xcbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLnRhYkluZGV4ID0gcGFyc2VJbnQodGFiaW5kZXgsIDEwKSB8fCAwO1xuXG4gICAgICAgIHRoaXMuX2Zvcm0gPSBfcGFyZW50Rm9ybSB8fCBfcGFyZW50Rm9ybUdyb3VwO1xuICAgICAgICBpZiAodGhpcy5fbmdDb250cm9sICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX25nQ29udHJvbC52YWx1ZUFjY2Vzc29yID0gdGhpcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgICAgICB0aGlzLmNoZWNrZWQgPSAhIXZhbHVlO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm46ICh2YWx1ZTogYW55KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX29uQ2hhbmdlRnVuYyA9IGZuO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fb25Ub3VjaEZ1bmMgPSBmbjtcbiAgICB9XG5cbiAgICBzZXREaXNhYmxlZFN0YXRlKGRpc2FibGVkVmFsOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBkaXNhYmxlZFZhbDtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy5fY2hlY2tib3hJbnB1dC5uYXRpdmVFbGVtZW50LCAnZGlzYWJsZWQnLCBkaXNhYmxlZFZhbCk7XG4gICAgfVxuXG4gICAgLyoqIFRvZ2dsZXMgdGhlIGN1cnJlbnQgY2hlY2tlZCBzdGF0ZSBvZiB0aGUgY2hlY2tib3ggKi9cbiAgICB0b2dnbGUoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XG4gICAgfVxuXG4gICAgX2NsaWNrRXZlbnQoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyAvLyBwcmV2ZW50IG5hdGl2ZSBjbGljayBldmVudCBmcm9tIGJlaW5nIGRpc3BhdGNoZWRcblxuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0Q2hhbmdlRXZlbnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9zdG9wQ2hhbmdlRXZlbnQoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyAvLyBwcmV2ZW50IG5hdGl2ZSBjaGFuZ2UgZXZlbnQgZnJvbSBlbWl0dGluZyBpdHMgb3duIG9iamVjdCB0aHJvdWdoIG91dHB1dCAnY2hhbmdlJ1xuICAgIH1cblxuICAgIHByaXZhdGUgX2VtaXRDaGFuZ2VFdmVudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fb25DaGFuZ2VGdW5jKHRoaXMuY2hlY2tlZCk7XG4gICAgICAgIHRoaXMuY2hhbmdlLmVtaXQobmV3IENoZWNrYm94Q2hhbmdlRXZlbnQodGhpcywgdGhpcy5jaGVja2VkKSk7XG4gICAgfVxuXG4gICAgX29uQmx1cigpIHtcbiAgICAgICAgdGhpcy5fb25Ub3VjaEZ1bmMoKTtcbiAgICB9XG5cbiAgICBuZ0RvQ2hlY2soKTogdm9pZCB7XG4gICAgICAgIC8vIFRoaXMgbmVlZHMgdG8gYmUgY2hlY2tlZCBldmVyeSBjeWNsZSBiZWNhdXNlIHdlIGNhbid0IHN1YnNjcmliZSB0byBmb3JtIHN1Ym1pc3Npb25zXG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUVycm9yU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgX3VwZGF0ZUVycm9yU3RhdGUoKSB7XG4gICAgICAgIGNvbnN0IG9sZFN0YXRlID0gdGhpcy5fZXJyb3JTdGF0ZTtcblxuICAgICAgICAvLyBUT0RPOiB0aGlzIGNvdWxkIGJlIGFic3RyYWN0ZWQgb3V0IGFzIGFuIEBJbnB1dCgpIGlmIHdlIG5lZWQgdGhpcyB0byBiZSBjb25maWd1cmFibGVcbiAgICAgICAgY29uc3QgbmV3U3RhdGUgPSAhIShcbiAgICAgICAgICAgIHRoaXMuX25nQ29udHJvbCAmJlxuICAgICAgICAgICAgdGhpcy5fbmdDb250cm9sLmludmFsaWQgJiZcbiAgICAgICAgICAgICh0aGlzLl9uZ0NvbnRyb2wudG91Y2hlZCB8fCAodGhpcy5fZm9ybSAmJiB0aGlzLl9mb3JtLnN1Ym1pdHRlZCkpXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKG9sZFN0YXRlICE9PSBuZXdTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5fZXJyb3JTdGF0ZSA9IG5ld1N0YXRlO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19