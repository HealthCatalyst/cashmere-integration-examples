/**
 * @fileoverview added by tsickle
 * Generated from: lib/navbar/navbar.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ContentChildren, ElementRef, HostListener, Input, QueryList, ViewChild, ViewEncapsulation } from '@angular/core';
import { HcPopoverAnchorDirective } from '../pop/directives/popover-anchor.directive';
import { NavbarLinkComponent } from './navbar-link/navbar-link.component';
import { NavbarMobileMenuComponent } from './navbar-mobile-menu/navbar-mobile-menu.component';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
/**
 * The navbar is a wrapper that positions branding, navigation, and other elements in a concise header.
 */
export class NavbarComponent {
    /**
     * @param {?} ref
     */
    constructor(ref) {
        this.ref = ref;
        /**
         * Display name of current user
         */
        this.user = '';
        /**
         * Url to application logo image file
         */
        this.appIcon = '';
        /**
         * Either url to brand icon image file or HcIcon object for a font glyph
         */
        this.brandIcon = '';
        /**
         * Router link triggered when home icon is clicked
         */
        this.homeUri = '';
        /**
         * Fixes the position of navbar to the top of the page. *Default is false.*
         */
        this.fixedTop = false;
        this.unsubscribe$ = new Subject();
        this._menuOpen = false;
        this._linkWidths = [];
        this._linksTotalWidth = 0;
        this._collapse = false;
        this._moreList = [];
    }
    /**
     * @return {?}
     */
    _navResize() {
        if (this._navbarMore) {
            this._navbarMore.closePopover();
        }
        this._moreList = [];
        this._collapse = false;
        // If links is zero the page is smaller than the first responsive breakpoint
        if (this.navbarContent.nativeElement.clientWidth <= 0) {
            return;
        }
        /** @type {?} */
        let linksContainerWidth = this.navContent.nativeElement.offsetWidth;
        /** @type {?} */
        let curLinks = 0;
        // Step through the links until we hit the end of the container, then collapse the
        // remaining into a more menu
        this._navLinks.forEach((/**
         * @param {?} t
         * @param {?} i
         * @return {?}
         */
        (t, i) => {
            curLinks += this._linkWidths[i];
            /** @type {?} */
            let moreWidth = this._linksTotalWidth > linksContainerWidth ? 116 : 0;
            if (curLinks + moreWidth < linksContainerWidth) {
                t.show();
            }
            else {
                t.hide();
                this._collapse = true;
                this._moreList.push({ name: t.linkText, uri: t.uri });
            }
        }));
        this.ref.detectChanges();
    }
    /**
     * Forces a recalculation of the navbar links to determine how many should be rolling into a More menu.
     * Call this if you've updated the contents of any navbar links.
     * @return {?}
     */
    refreshNavLinks() {
        this._collectNavLinkWidths();
        this._navResize();
    }
    /**
     * @private
     * @return {?}
     */
    _collectNavLinkWidths() {
        this._linkWidths = [];
        this._linksTotalWidth = 0;
        this._navLinks.forEach((/**
         * @param {?} t
         * @return {?}
         */
        t => {
            /** @type {?} */
            const isHidden = t._hidden;
            t.show();
            this._linksTotalWidth += t._getWidth();
            this._linkWidths.push(t._getWidth());
            if (isHidden) {
                t.hide();
            }
        }));
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.refreshNavLinks();
        }), 100);
        // If links are added dynamically, recheck the navbar link sizing
        this._navLinks.changes.pipe(takeUntil(this.unsubscribe$)).subscribe((/**
         * @return {?}
         */
        () => this.refreshNavLinks()));
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.unsubscribe$.next();
        this.unsubscribe$.complete();
    }
    /**
     * @return {?}
     */
    _toggleMobileMenu() {
        if (this._menuOpen) {
            this._mobileMenu.first.hide();
            this._menuOpen = false;
        }
        else {
            this._mobileMenu.first.show();
            this._menuOpen = true;
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    _menuClick(event) {
        /** @type {?} */
        let clickTarget = event.target.outerHTML;
        // Verify that the click in the mobile menu came from a navigation item
        if (clickTarget.indexOf('hclistline') >= 0 && clickTarget.indexOf('menu-dropdown') === -1) {
            this._toggleMobileMenu();
        }
    }
    /**
     * @return {?}
     */
    get _mobileMenuIcon() {
        return this._menuOpen ? 'fa-times' : 'fa-bars';
    }
    /**
     * @return {?}
     */
    _moreClick() {
        if (this._navbarMore) {
            this._navbarMore.closePopover();
        }
    }
    /**
     * @return {?}
     */
    _brandIconType() {
        return typeof this.brandIcon;
    }
    /**
     * @return {?}
     */
    _brandIconSet() {
        if (this.brandIcon && typeof this.brandIcon !== 'string') {
            return this.brandIcon.fontSet;
        }
        else {
            return '';
        }
    }
    /**
     * @return {?}
     */
    _brandIconGlyph() {
        if (this.brandIcon && typeof this.brandIcon !== 'string') {
            return this.brandIcon.fontIcon;
        }
        else {
            return '';
        }
    }
    /**
     * @return {?}
     */
    _brandIconSize() {
        if (this.brandIcon && typeof this.brandIcon !== 'string' && this.brandIcon.fontSize) {
            return this.brandIcon.fontSize + 'px';
        }
        return '37px';
    }
}
NavbarComponent.decorators = [
    { type: Component, args: [{
                selector: 'hc-navbar',
                template: "<nav #navbar class=\"hc-navbar\" [ngClass]=\"{'fixed-top': fixedTop}\">\n    <div class=\"navbar-brand\">\n        <a [routerLink]=\"homeUri\" class=\"brand\">\n            <img *ngIf=\"_brandIconType() == 'string'\" src=\"{{brandIcon}}\">\n            <hc-icon\n                *ngIf=\"_brandIconType() != 'string'\"\n                [fontSet]=\"_brandIconSet()\"\n                [fontIcon]=\"_brandIconGlyph()\"\n                [ngStyle]=\"{height: _brandIconSize(), 'font-size': _brandIconSize()}\">\n            </hc-icon>\n        </a>\n    </div>\n    <div class=\"navbar-app\">\n        <a [routerLink]=\"homeUri\" class=\"app\" *ngIf=\"appIcon\">\n            <img src=\"{{appIcon}}\">\n        </a>\n    </div>\n    <div #navlinks class=\"hc-navbar-link-container\">\n        <ng-content select=\"hc-navbar-link\"></ng-content>\n        <div class=\"hc-navbar-more-links\" title=\"More\" *ngIf=\"_collapse\" [hcPop]=\"navbarMore\" #moreLink=\"hcPopAnchor\">\n            More<hc-icon fontSet=\"fa\" fontIcon=\"fa-chevron-down\" hcIconSm></hc-icon>\n        </div>\n    </div>\n\n    <div #rightcontainer class=\"hc-navbar-right-container\">\n        <ng-content></ng-content>\n    </div>\n    <div class=\"hc-navbar-mobile-menu\" *ngIf=\"_mobileMenu.first\" (click)=\"_toggleMobileMenu()\">\n        <hc-icon fontSet=\"fa\" [fontIcon]=\"_mobileMenuIcon\" hcIconMd></hc-icon>\n    </div>\n</nav>\n<div (click)=\"_menuClick($event)\">\n    <ng-content select=\"hc-navbar-mobile-menu\"></ng-content>\n</div>\n\n<hc-pop #navbarMore [autoCloseOnContentClick]=\"true\" [showArrow]=\"false\" horizontalAlign=\"end\">\n    <div hcMenu>\n        <ng-container *ngFor=\"let item of _moreList; let i = index\">\n            <button hcMenuItem routerLinkActive=\"active\" [routerLink]=\"item.uri\" (click)=\"_moreClick()\">\n                <span hcMenuText>{{item.name}}</span>\n            </button>\n            <div *ngIf=\"i != _moreList.length - 1\" hcMenuItem hcDivider></div>\n        </ng-container>\n    </div>\n</hc-pop>\n",
                encapsulation: ViewEncapsulation.None,
                styles: [".hc-navbar{height:53px;background-color:#384655;display:-webkit-box;display:flex;font-size:15px;line-height:1}.hc-navbar.fixed-top{top:0;position:fixed;right:0;left:0;z-index:970;box-shadow:0 2px 6px rgba(0,0,0,.15)}.hc-navbar .navbar-brand{background-color:#00aeff;min-width:55px;width:55px;flex-basis:auto;height:100%;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.hc-navbar .navbar-brand .brand{-webkit-transition:background-color .25s;transition:background-color .25s;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;cursor:default}.hc-navbar .navbar-brand .brand>img{height:37px;width:auto}.hc-navbar .navbar-brand .brand>hc-icon{width:100%;color:#fff}.hc-navbar .navbar-app{height:100%;padding:0 50px 0 25px}.hc-navbar .navbar-app a{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;height:100%}.hc-navbar .navbar-app a img{height:30px;width:auto;padding-top:2px}@media (max-width:576px){.hc-navbar .navbar-brand{display:none}.hc-navbar .navbar-app{padding:0 0 0 5%}}.hc-navbar .hc-navbar-link-container{display:-webkit-box;display:flex;list-style-type:none;margin:0;padding:0;overflow:hidden;width:100%}@media (max-width:768px){.hc-navbar .hc-navbar-link-container{display:none}}.hc-navbar .navbar-link{display:inline-block;height:100%;box-sizing:border-box;padding:22px 30px 0;text-align:center;white-space:nowrap;color:#ccc;border-bottom:5px solid transparent;-webkit-transition:background-color .25s;transition:background-color .25s}.hc-navbar .navbar-link.inactive:hover,.hc-navbar .navbar-link:hover:not(.active){outline:0;color:#fff;background-color:#2e3946}.hc-navbar .navbar-link.active:not(.inactive),.hc-navbar .navbar-link:active{color:#fff;font-weight:600;border-bottom:5px solid #00aeff}.hc-navbar .navbar-link:before{display:block;content:attr(title);font-weight:600;height:1px;color:transparent;overflow:hidden;visibility:hidden;margin-bottom:-1px}.hc-navbar .hc-navbar-right-container{display:-webkit-box;display:flex;-webkit-box-flex:0;flex:0 0 auto;-webkit-box-align:center;align-items:center;position:relative;margin-left:auto}@media (max-width:768px){.hc-navbar .hc-navbar-right-container{display:none}}.hc-navbar .hc-navbar-icon{height:53px;color:#fff;cursor:pointer;-webkit-transition:background-color .25s;transition:background-color .25s;min-width:53px!important;padding:18px 0}.hc-navbar .hc-navbar-icon.inactive:hover,.hc-navbar .hc-navbar-icon:hover:not(.active){outline:0;color:#fff;background-color:#2e3946}.hc-navbar .hc-navbar-username{height:53px;color:#fff;cursor:pointer;-webkit-transition:background-color .25s;transition:background-color .25s;padding:2px 15px 0;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;white-space:nowrap}.hc-navbar .hc-navbar-username.inactive:hover,.hc-navbar .hc-navbar-username:hover:not(.active){outline:0;color:#fff;background-color:#2e3946}.hc-navbar .hc-navbar-username>hc-icon{font-size:12pt;padding-top:2px}.hc-navbar .hc-navbar-username-subtext{color:#c0c5cc}.hc-navbar .hc-navbar-vertical-separator{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.hc-navbar .hc-navbar-vertical-separator::after{content:'|';font-size:18px;color:#fff}.hc-navbar .hc-navbar-more-links{display:inline-block;white-space:nowrap;cursor:pointer;height:100%;box-sizing:border-box;padding:22px 30px 0;text-align:center;color:#ccc;border-bottom:5px solid transparent;-webkit-transition:background-color .25s;transition:background-color .25s}.hc-navbar .hc-navbar-more-links hc-icon{margin-left:5px;vertical-align:top;margin-top:1px;font-size:13px!important}.hc-navbar .hc-navbar-more-links.inactive:hover,.hc-navbar .hc-navbar-more-links:hover:not(.active){outline:0;color:#fff;background-color:#2e3946}.hc-navbar .hc-navbar-more-links:before{display:block;content:attr(title);font-weight:600;height:1px;color:transparent;overflow:hidden;visibility:hidden;margin-bottom:-1px}.hc-navbar .hc-navbar-mobile-menu{background-color:#262f34;color:#d7dde4;width:55px;flex-basis:auto;height:100%;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;margin-left:auto;cursor:pointer;display:none}.hc-navbar .hc-navbar-mobile-menu hc-icon{font-size:25px!important;height:25px!important;width:25px!important}@media (max-width:768px){.hc-navbar .hc-navbar-mobile-menu{display:-webkit-box;display:flex}}"]
            }] }
];
/** @nocollapse */
NavbarComponent.ctorParameters = () => [
    { type: ChangeDetectorRef }
];
NavbarComponent.propDecorators = {
    user: [{ type: Input }],
    appIcon: [{ type: Input }],
    brandIcon: [{ type: Input }],
    homeUri: [{ type: Input }],
    fixedTop: [{ type: Input }],
    _mobileMenu: [{ type: ContentChildren, args: [NavbarMobileMenuComponent,] }],
    _navLinks: [{ type: ContentChildren, args: [NavbarLinkComponent,] }],
    navbarContent: [{ type: ViewChild, args: ['navbar', { static: false },] }],
    navContent: [{ type: ViewChild, args: ['navlinks', { static: false },] }],
    _navbarMore: [{ type: ViewChild, args: ['moreLink', { static: false },] }],
    _navResize: [{ type: HostListener, args: ['window:resize',] }]
};
if (false) {
    /**
     * Display name of current user
     * @type {?}
     */
    NavbarComponent.prototype.user;
    /**
     * Url to application logo image file
     * @type {?}
     */
    NavbarComponent.prototype.appIcon;
    /**
     * Either url to brand icon image file or HcIcon object for a font glyph
     * @type {?}
     */
    NavbarComponent.prototype.brandIcon;
    /**
     * Router link triggered when home icon is clicked
     * @type {?}
     */
    NavbarComponent.prototype.homeUri;
    /**
     * Fixes the position of navbar to the top of the page. *Default is false.*
     * @type {?}
     */
    NavbarComponent.prototype.fixedTop;
    /** @type {?} */
    NavbarComponent.prototype._mobileMenu;
    /** @type {?} */
    NavbarComponent.prototype._navLinks;
    /** @type {?} */
    NavbarComponent.prototype.navbarContent;
    /** @type {?} */
    NavbarComponent.prototype.navContent;
    /** @type {?} */
    NavbarComponent.prototype._navbarMore;
    /**
     * @type {?}
     * @private
     */
    NavbarComponent.prototype.unsubscribe$;
    /**
     * @type {?}
     * @private
     */
    NavbarComponent.prototype._menuOpen;
    /**
     * @type {?}
     * @private
     */
    NavbarComponent.prototype._linkWidths;
    /**
     * @type {?}
     * @private
     */
    NavbarComponent.prototype._linksTotalWidth;
    /** @type {?} */
    NavbarComponent.prototype._collapse;
    /** @type {?} */
    NavbarComponent.prototype._moreList;
    /**
     * @type {?}
     * @private
     */
    NavbarComponent.prototype.ref;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2YmFyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BoZWFsdGhjYXRhbHlzdC9jYXNobWVyZS8iLCJzb3VyY2VzIjpbImxpYi9uYXZiYXIvbmF2YmFyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFFSCxpQkFBaUIsRUFDakIsU0FBUyxFQUNULGVBQWUsRUFDZixVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFDTCxTQUFTLEVBQ1QsU0FBUyxFQUNULGlCQUFpQixFQUVwQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUMsd0JBQXdCLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQztBQUVwRixPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUN4RSxPQUFPLEVBQUMseUJBQXlCLEVBQUMsTUFBTSxtREFBbUQsQ0FBQztBQUM1RixPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQzdCLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQzs7OztBQVV6QyxNQUFNLE9BQU8sZUFBZTs7OztJQTRFeEIsWUFBb0IsR0FBc0I7UUFBdEIsUUFBRyxHQUFILEdBQUcsQ0FBbUI7Ozs7UUF6RTFDLFNBQUksR0FBVyxFQUFFLENBQUM7Ozs7UUFJbEIsWUFBTyxHQUFXLEVBQUUsQ0FBQzs7OztRQUlyQixjQUFTLEdBQW9CLEVBQUUsQ0FBQzs7OztRQUloQyxZQUFPLEdBQW1CLEVBQUUsQ0FBQzs7OztRQUk3QixhQUFRLEdBQVksS0FBSyxDQUFDO1FBY2xCLGlCQUFZLEdBQUcsSUFBSSxPQUFPLEVBQVEsQ0FBQztRQUVuQyxjQUFTLEdBQVksS0FBSyxDQUFDO1FBQzNCLGdCQUFXLEdBQWtCLEVBQUUsQ0FBQztRQUNoQyxxQkFBZ0IsR0FBVyxDQUFDLENBQUM7UUFDOUIsY0FBUyxHQUFZLEtBQUssQ0FBQztRQUMzQixjQUFTLEdBQW9CLEVBQUUsQ0FBQztJ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c0M7Ozs7O0lBRXRDLHVDQUEyQzs7Ozs7SUFFM0Msb0NBQW1DOzs7OztJQUNuQyxzQ0FBd0M7Ozs7O0lBQ3hDLDJDQUFxQzs7SUFDckMsb0NBQWtDOztJQUNsQyxvQ0FBdUM7Ozs7O0lBcUMzQiw4QkFBOEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIENvbnRlbnRDaGlsZHJlbixcbiAgICBFbGVtZW50UmVmLFxuICAgIEhvc3RMaXN0ZW5lcixcbiAgICBJbnB1dCxcbiAgICBRdWVyeUxpc3QsXG4gICAgVmlld0NoaWxkLFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxuICAgIE9uRGVzdHJveVxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7SGNQb3BvdmVyQW5jaG9yRGlyZWN0aXZlfSBmcm9tICcuLi9wb3AvZGlyZWN0aXZlcy9wb3BvdmVyLWFuY2hvci5kaXJlY3RpdmUnO1xuaW1wb3J0IHtNb3JlSXRlbX0gZnJvbSAnLi9tb3JlLWl0ZW0nO1xuaW1wb3J0IHtOYXZiYXJMaW5rQ29tcG9uZW50fSBmcm9tICcuL25hdmJhci1saW5rL25hdmJhci1saW5rLmNvbXBvbmVudCc7XG5pbXBvcnQge05hdmJhck1vYmlsZU1lbnVDb21wb25lbnR9IGZyb20gJy4vbmF2YmFyLW1vYmlsZS1tZW51L25hdmJhci1tb2JpbGUtbWVudS5jb21wb25lbnQnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7dGFrZVVudGlsfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0hjSWNvbn0gZnJvbSAnLi4vaWNvbi9pY29uLmNvbXBvbmVudCc7XG5cbi8qKiBUaGUgbmF2YmFyIGlzIGEgd3JhcHBlciB0aGF0IHBvc2l0aW9ucyBicmFuZGluZywgbmF2aWdhdGlvbiwgYW5kIG90aGVyIGVsZW1lbnRzIGluIGEgY29uY2lzZSBoZWFkZXIuICovXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2hjLW5hdmJhcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL25hdmJhci5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbmF2YmFyLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxufSlcbmV4cG9ydCBjbGFzcyBOYXZiYXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuICAgIC8qKiBEaXNwbGF5IG5hbWUgb2YgY3VycmVudCB1c2VyICovXG4gICAgQElucHV0KClcbiAgICB1c2VyOiBzdHJpbmcgPSAnJztcblxuICAgIC8qKiBVcmwgdG8gYXBwbGljYXRpb24gbG9nbyBpbWFnZSBmaWxlICovXG4gICAgQElucHV0KClcbiAgICBhcHBJY29uOiBzdHJpbmcgPSAnJztcblxuICAgIC8qKiBFaXRoZXIgdXJsIHRvIGJyYW5kIGljb24gaW1hZ2UgZmlsZSBvciBIY0ljb24gb2JqZWN0IGZvciBhIGZvbnQgZ2x5cGggKi9cbiAgICBASW5wdXQoKVxuICAgIGJyYW5kSWNvbjogc3RyaW5nIHwgSGNJY29uID0gJyc7XG5cbiAgICAvKiogUm91dGVyIGxpbmsgdHJpZ2dlcmVkIHdoZW4gaG9tZSBpY29uIGlzIGNsaWNrZWQgKi9cbiAgICBASW5wdXQoKVxuICAgIGhvbWVVcmk6IGFueVtdIHwgc3RyaW5nID0gJyc7XG5cbiAgICAvKiogRml4ZXMgdGhlIHBvc2l0aW9uIG9mIG5hdmJhciB0byB0aGUgdG9wIG9mIHRoZSBwYWdlLiAqRGVmYXVsdCBpcyBmYWxzZS4qICovXG4gICAgQElucHV0KClcbiAgICBmaXhlZFRvcDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgQENvbnRlbnRDaGlsZHJlbihOYXZiYXJNb2JpbGVNZW51Q29tcG9uZW50KVxuICAgIF9tb2JpbGVNZW51OiBRdWVyeUxpc3Q8TmF2YmFyTW9iaWxlTWVudUNvbXBvbmVudD47XG5cbiAgICBAQ29udGVudENoaWxkcmVuKE5hdmJhckxpbmtDb21wb25lbnQpXG4gICAgX25hdkxpbmtzOiBRdWVyeUxpc3Q8TmF2YmFyTGlua0NvbXBvbmVudD47XG5cbiAgICBAVmlld0NoaWxkKCduYXZiYXInLCB7c3RhdGljOiBmYWxzZX0pIG5hdmJhckNvbnRlbnQ6IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgnbmF2bGlua3MnLCB7c3RhdGljOiBmYWxzZX0pIG5hdkNvbnRlbnQ6IEVsZW1lbnRSZWY7XG5cbiAgICBAVmlld0NoaWxkKCdtb3JlTGluaycsIHtzdGF0aWM6IGZhbHNlfSlcbiAgICBfbmF2YmFyTW9yZTogSGNQb3BvdmVyQW5jaG9yRGlyZWN0aXZlO1xuXG4gICAgcHJpdmF0ZSB1bnN1YnNjcmliZSQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gICAgcHJpdmF0ZSBfbWVudU9wZW46IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIF9saW5rV2lkdGhzOiBBcnJheTxudW1iZXI+ID0gW107XG4gICAgcHJpdmF0ZSBfbGlua3NUb3RhbFdpZHRoOiBudW1iZXIgPSAwO1xuICAgIHB1YmxpYyBfY29sbGFwc2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgX21vcmVMaXN0OiBBcnJheTxNb3JlSXRlbT4gPSBbXTtcblxuICAgIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpyZXNpemUnKVxuICAgIF9uYXZSZXNpemUoKSB7XG4gICAgICAgIGlmICh0aGlzLl9uYXZiYXJNb3JlKSB7XG4gICAgICAgICAgICB0aGlzLl9uYXZiYXJNb3JlLmNsb3NlUG9wb3ZlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbW9yZUxpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5fY29sbGFwc2UgPSBmYWxzZTtcblxuICAgICAgICAvLyBJZiBsaW5rcyBpcyB6ZXJvIHRoZSBwYWdlIGlzIHNtYWxsZXIgdGhhbiB0aGUgZmlyc3QgcmVzcG9uc2l2ZSBicmVha3BvaW50XG4gICAgICAgIGlmICh0aGlzLm5hdmJhckNvbnRlbnQubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aCA8PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbGlua3NDb250YWluZXJXaWR0aDogbnVtYmVyID0gdGhpcy5uYXZDb250ZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGxldCBjdXJMaW5rczogbnVtYmVyID0gMDtcblxuICAgICAgICAvLyBTdGVwIHRocm91Z2ggdGhlIGxpbmtzIHVudGlsIHdlIGhpdCB0aGUgZW5kIG9mIHRoZSBjb250YWluZXIsIHRoZW4gY29sbGFwc2UgdGhlXG4gICAgICAgIC8vIHJlbWFpbmluZyBpbnRvIGEgbW9yZSBtZW51XG4gICAgICAgIHRoaXMuX25hdkxpbmtzLmZvckVhY2goKHQsIGkpID0+IHtcbiAgICAgICAgICAgIGN1ckxpbmtzICs9IHRoaXMuX2xpbmtXaWR0aHNbaV07XG5cbiAgICAgICAgICAgIGxldCBtb3JlV2lkdGg6IG51bWJlciA9IHRoaXMuX2xpbmtzVG90YWxXaWR0aCA+IGxpbmtzQ29udGFpbmVyV2lkdGggPyAxMTYgOiAwO1xuICAgICAgICAgICAgaWYgKGN1ckxpbmtzICsgbW9yZVdpZHRoIDwgbGlua3NDb250YWluZXJXaWR0aCkge1xuICAgICAgICAgICAgICAgIHQuc2hvdygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0LmhpZGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2xsYXBzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9yZUxpc3QucHVzaCh7bmFtZTogdC5saW5rVGV4dCwgdXJpOiB0LnVyaX0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWY6IENoYW5nZURldGVjdG9yUmVmKSB7fVxuXG4gICAgLyoqIEZvcmNlcyBhIHJlY2FsY3VsYXRpb24gb2YgdGhlIG5hdmJhciBsaW5rcyB0byBkZXRlcm1pbmUgaG93IG1hbnkgc2hvdWxkIGJlIHJvbGxpbmcgaW50byBhIE1vcmUgbWVudS5cbiAgICAgKiBDYWxsIHRoaXMgaWYgeW91J3ZlIHVwZGF0ZWQgdGhlIGNvbnRlbnRzIG9mIGFueSBuYXZiYXIgbGlua3MuICovXG4gICAgcmVmcmVzaE5hdkxpbmtzKCkge1xuICAgICAgICB0aGlzLl9jb2xsZWN0TmF2TGlua1dpZHRocygpO1xuICAgICAgICB0aGlzLl9uYXZSZXNpemUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jb2xsZWN0TmF2TGlua1dpZHRocygpIHtcbiAgICAgICAgdGhpcy5fbGlua1dpZHRocyA9IFtdO1xuICAgICAgICB0aGlzLl9saW5rc1RvdGFsV2lkdGggPSAwO1xuICAgICAgICB0aGlzLl9uYXZMaW5rcy5mb3JFYWNoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNIaWRkZW4gPSB0Ll9oaWRkZW47XG4gICAgICAgICAgICB0LnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuX2xpbmtzVG90YWxXaWR0aCArPSB0Ll9nZXRXaWR0aCgpO1xuICAgICAgICAgICAgdGhpcy5fbGlua1dpZHRocy5wdXNoKHQuX2dldFdpZHRoKCkpO1xuICAgICAgICAgICAgaWYgKGlzSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgdC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hOYXZMaW5rcygpO1xuICAgICAgICB9LCAxMDApO1xuXG4gICAgICAgIC8vIElmIGxpbmtzIGFyZSBhZGRlZCBkeW5hbWljYWxseSwgcmVjaGVjayB0aGUgbmF2YmFyIGxpbmsgc2l6aW5nXG4gICAgICAgIHRoaXMuX25hdkxpbmtzLmNoYW5nZXMucGlwZSh0YWtlVW50aWwodGhpcy51bnN1YnNjcmliZSQpKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5yZWZyZXNoTmF2TGlua3MoKSk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmUkLm5leHQoKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBfdG9nZ2xlTW9iaWxlTWVudSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX21lbnVPcGVuKSB7XG4gICAgICAgICAgICB0aGlzLl9tb2JpbGVNZW51LmZpcnN0LmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuX21lbnVPcGVuID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9tb2JpbGVNZW51LmZpcnN0LnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuX21lbnVPcGVuID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9tZW51Q2xpY2soZXZlbnQ6IGFueSkge1xuICAgICAgICBsZXQgY2xpY2tUYXJnZXQ6IHN0cmluZyA9IGV2ZW50LnRhcmdldC5vdXRlckhUTUw7XG5cbiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgdGhlIGNsaWNrIGluIHRoZSBtb2JpbGUgbWVudSBjYW1lIGZyb20gYSBuYXZpZ2F0aW9uIGl0ZW1cbiAgICAgICAgaWYgKGNsaWNrVGFyZ2V0LmluZGV4T2YoJ2hjbGlzdGxpbmUnKSA+PSAwICYmIGNsaWNrVGFyZ2V0LmluZGV4T2YoJ21lbnUtZHJvcGRvd24nKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZU1vYmlsZU1lbnUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBfbW9iaWxlTWVudUljb24oKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21lbnVPcGVuID8gJ2ZhLXRpbWVzJyA6ICdmYS1iYXJzJztcbiAgICB9XG5cbiAgICBfbW9yZUNsaWNrKCkge1xuICAgICAgICBpZiAodGhpcy5fbmF2YmFyTW9yZSkge1xuICAgICAgICAgICAgdGhpcy5fbmF2YmFyTW9yZS5jbG9zZVBvcG92ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9icmFuZEljb25UeXBlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5icmFuZEljb247XG4gICAgfVxuXG4gICAgX2JyYW5kSWNvblNldCgpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5icmFuZEljb24gJiYgdHlwZW9mIHRoaXMuYnJhbmRJY29uICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnJhbmRJY29uLmZvbnRTZXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfYnJhbmRJY29uR2x5cGgoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRoaXMuYnJhbmRJY29uICYmIHR5cGVvZiB0aGlzLmJyYW5kSWNvbiAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJyYW5kSWNvbi5mb250SWNvbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9icmFuZEljb25TaXplKCk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aGlzLmJyYW5kSWNvbiAmJiB0eXBlb2YgdGhpcy5icmFuZEljb24gIT09ICdzdHJpbmcnICYmIHRoaXMuYnJhbmRJY29uLmZvbnRTaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5icmFuZEljb24uZm9udFNpemUgKyAncHgnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnMzdweCc7XG4gICAgfVxufVxuIl19